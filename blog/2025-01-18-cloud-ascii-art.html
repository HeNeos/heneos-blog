<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/cloud/ascii_art/ascii_art_ascii.png"/><link rel="preload" as="image" href="https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/cloud/ascii_art/heneos_ascii.png"/><link rel="preload" as="image" href="https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/cloud/ascii_art/jaden_ascii.png"/><link rel="preload" as="image" href="https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/cloud/ascii_art/david_ascii.png"/><link rel="preload" as="image" href="https://projecteuler.net/profile/HeNeos.png"/><link rel="stylesheet" href="/heneos-blog/_next/static/css/10c5481d6c776747.css" data-precedence="next"/><link rel="stylesheet" href="/heneos-blog/_next/static/css/31789995b2727dcb.css" data-precedence="next"/><link rel="stylesheet" href="/heneos-blog/_next/static/css/5eacd01f773eed7f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/heneos-blog/_next/static/chunks/webpack-f5e2af5b5e96ca99.js"/><script src="/heneos-blog/_next/static/chunks/4bd1b696-2bfa57da125389e3.js" async=""></script><script src="/heneos-blog/_next/static/chunks/587-b330864006e0cdca.js" async=""></script><script src="/heneos-blog/_next/static/chunks/main-app-c254e3910443191a.js" async=""></script><script src="/heneos-blog/_next/static/chunks/app/blog/%5Bslug%5D/page-4374ee6693381f28.js" async=""></script><title>Ascii Art | HeNeos blog</title><meta name="description" content="Implement a non-naive ascii art"/><script src="/heneos-blog/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="bg-zinc-950 text-zinc-100 min-h-screen"><header class="p-6 border-b border-zinc-800"><div class="max-w-6xl mx-auto"><div class="mb-10"><h1 class="text-6xl font-raleway tracking-tighter mb-2 text-center">HeNeos blog</h1><p class="text-xl font-mono text-center text-zinc-500 mb-1">Josue H. @ JP Morgan Chase</p><p class="text-xl font-raleway text-center text-zinc-600">HeNeos</p></div><div class="flex justify-center space-x-20 mb-4"><a target="_blank" class="text-base font-raleway text-zinc-500 hover:text-accent animated-underline" href="https://github.com/HeNeos">GitHub</a><a target="_blank" class="text-base font-raleway text-zinc-500 hover:text-accent animated-underline" href="https://www.linkedin.com/in/heneos">LinkedIn</a><a class="text-base font-raleway text-zinc-500 hover:text-accent animated-underline" href="mailto:he.neos@outlook.com">Email</a></div><div class="text-xl font-raleway flex flex-col sm:flex-row justify-center gap-4 border-t border-zinc-800 pt-4"><a href="/heneos-blog"><div class="cursor-pointer hover:bg-gray-200 hover:text-zinc-900 transition-colors px-4 py-2 rounded-md flex items-center justify-between"><span>Home</span><span class="text-zinc-500 ml-6">ha</span></div></a><a href="/heneos-blog/blog"><div class="cursor-pointer hover:bg-gray-200 hover:text-zinc-900 transition-colors px-4 py-2 rounded-md flex items-center justify-between"><span>Blog</span><span class="text-zinc-500 ml-6">hb</span></div></a><a href="/heneos-blog/about"><div class="cursor-pointer hover:bg-gray-200 hover:text-zinc-900 transition-colors px-4 py-2 rounded-md flex items-center justify-between"><span>About</span><span class="text-zinc-500 ml-6">hc</span></div></a></div></div></header><main class="container mx-auto px-4 py-8 max-w-5xl"><div class="max-w-5xl mx-auto"><a class="text-zinc-500 hover:text-blue-400 mb-6 inline-block animated-underline" href="/heneos-blog/blog">‚Üê Back to all posts</a><article class="border border-zinc-800 rounded-lg p-4 bg-zinc-900/30"><header class="mb-8 border-b border-zinc-800 pb-6"><h1 class="text-3xl font-bold mb-4 gradient-text">Ascii Art</h1><p class="text-zinc-500 mb-4 font-mono">January 18, 2025</p><div class="flex gap-2 flex-wrap"><span class="inline-block bg-zinc-800 text-zinc-300 px-2 py-1 text-xs rounded-sm">#<!-- -->cloud</span><span class="inline-block bg-zinc-800 text-zinc-300 px-2 py-1 text-xs rounded-sm">#<!-- -->image-processing</span></div></header><div class="gap-4 mt-8"><div class="prose prose-invert prose-zinc max-w-none"><p class="text-base text-zinc-300 my-4 leading-relaxed">I&#x27;ve been inactive on writing for a long time, many thins happened. I&#x27;m also now AWS SysOps certified, it went better than I thought. Anyway, let&#x27;s start with the topic of this entry.</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">I&#x27;ve been working for several months on ascii art, just as a quick introduction to it, ascii art is the process to represent images with ascii characters. You may be wondering how is that possible?, if you think about images, you will remember that it&#x27;s compound of pixels, a lot of them, if instead of pixels we replace them with ascii characters, would it work?... Yes, but no.</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">It&#x27;s the basic idea, but we are gonna deep dive more into this, otherwise I had not been doing that for several months.</p>
<div class="image-container my-8"><img src="https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/cloud/ascii_art/ascii_art_ascii.png" alt="ASCII Art" width="100%" height="auto" class="object-contain mx-auto"/></div>
<h2 class="text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2">Basic ascii art</h2>
<p class="text-base text-zinc-300 my-4 leading-relaxed">Let&#x27;s start with the basic idea, and then go further from it. If we replace every pixel with a character, the first question is to which character?, how is possible to map every possible pixel (24 bits) to a character (8 bits)?</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">Let&#x27;s think for a moment only for a grayscale image, then instead there are only 256 possible pixels, which is much less than <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>24</mn></msup></mrow><annotation encoding="application/x-tex">2^{24}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">24</span></span></span></span></span></span></span></span></span></span></span></span>. Now, how can we assign a character to a pixel value? Well, not all ascii characters covers the screen in the same <em>intensity</em>, for example, compare this character <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">-</code> with <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">@</code>, so it makes sense so to assign the characters that less cover the screen with the lowest values in the grayscale (the darker colors) and the brighter pixels with something like <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">@</code>.</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">We have another problem here, despite there are 256 ascii characters, not all of them are printable. However, this is easy to solve, just define ranges where each printable ascii character should map to a grayscale value, you can decide if make this scale linear or not.</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">And that&#x27;s it, now you have a way to put ascii characters instead of pixels, so we are done, right? Not really, it&#x27;s true that now we replaced every character with a pixel and that should work but, a printed ascii character doesn&#x27;t have the dimensions of a pixel, it depends about the fontsize but in almost all cases, the aspect ratio for a character is not 1:1, it means if you replace every pixel with a character you will see a deformed image, to solve this, easy way is to first modify aspect ratio of the original image, according to your font size, in most cases doubling the width should be enough as a good approximation.</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">We have another problem, our output image resolution is too big, why? Well, since we discussed before, a character doesn&#x27;t have the same size as a pixel and depending of your font size it could be bigger, imagine for example if your font takes 12 pixels as height and 8 and width, if you did the rescale to preserve the original aspect ratio of the image then now your output image will be 144 times bigger than before. To solve this issue, you can just downscale the image, reduce the original size so that the output image despite of being multiplied by 144 is still manageable.</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">We&#x27;ve now solved how to do the ascii art for grayscale images, but not all images are grayscale, most of them are in color, so what can we do? Easy, convert them to grayscale, or use this formula <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">0.299 Red + 0.587 Green + 0.114 Blue</code>.</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">And that&#x27;s it, it covers a basic ascii art that you can find around the internet.</p>
<div class="image-container my-8"><img src="https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/cloud/ascii_art/heneos_ascii.png" alt="" width="80%" height="auto" class="object-contain mx-auto"/></div>
<h2 class="text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2">Colored ascii art</h2>
<p class="text-base text-zinc-300 my-4 leading-relaxed">At this point, you&#x27;re able to have ascii art from any image preserving the aspect ratio and the size, but you notice an issue, most of the details are lost because even when ascii characters can show the <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">luminance</code> of the original image, they&#x27;re not able to show the <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">color</code>, so how to solve this?</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">Instead of printing the ascii character on a text based display, you can print it on a canvas or a created image, then you will have an image with tons of ascii characters that represents your original image. This concept will help us later when we wanna do videos.</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">In a canvas, you can select to which color you want to print your ascii character, since you already know the height and width of your font, you also know how to moves over the canvas.</p>
<div class="image-container my-8"><img src="https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/cloud/ascii_art/jaden_ascii.png" alt="" width="80%" height="auto" class="object-contain mx-auto"/></div>
<pre class="rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800"><code class="hljs language-py text-xs"><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_image</span>(<span class="hljs-params">
    image: npt.NDArray[np.uint8],
    char_arrays: <span class="hljs-built_in">list</span>[npt.NDArray[np.str_]],
</span>) -&gt; <span class="hljs-built_in">tuple</span>[<span class="hljs-built_in">list</span>[AsciiImage], AsciiColors, npt.NDArray[np.float64]]:

    <span class="hljs-comment"># custom grayscale</span>
    gray_array: npt.NDArray[np.float64] = np.clip(
        np.dot(image[..., :<span class="hljs-number">3</span>], [<span class="hljs-number">0.3090</span>, <span class="hljs-number">0.5670</span>, <span class="hljs-number">0.1240</span>]), <span class="hljs-number">0.0</span>, <span class="hljs-number">255.0</span>
    )

    ascii_chars: <span class="hljs-built_in">list</span>[npt.NDArray[np.str_]] = [
        map_to_char_vectorized(gray_array, char_array)
        <span class="hljs-keyword">for</span> char_array <span class="hljs-keyword">in</span> char_arrays
    ]

    grids: <span class="hljs-built_in">list</span>[AsciiImage] = [ascii_char.tolist() <span class="hljs-keyword">for</span> ascii_char <span class="hljs-keyword">in</span> ascii_chars]
    image_colors: AsciiColors = [row.tolist() <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> image]

    <span class="hljs-keyword">return</span> grids, image_colors, gray_array
</code></pre>
<h2 class="text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2">Video processing</h2>
<p class="text-base text-zinc-300 my-4 leading-relaxed">Now, instead of processing an image, we&#x27;re going to process a video, this step is fairly simple since this could be summarized as just applying the same idea to all frames and then merge them again.</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">It&#x27;s good but take into account two things, a video is commonly compressed to save storage with a lower bitrate. Merging all created images with our ascii art will create a heavy video if you don&#x27;t apply the appropiate compression.</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">For all of this stuff related with videos, I recommend to use ffmpeg and create your own small set of functions that call to ffmpeg, you&#x27;re gonna need it to resize the video, to split/merge frames and to extract/add the audio.</p>
<h2 class="text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2">Dithering</h2>
<p class="text-base text-zinc-300 my-4 leading-relaxed">You&#x27;ve probably notices on your videos those ugly color bands. It&#x27;s just disgusting... it&#x27;s happening because our character space is not as big as the original pixel one. Hopefully, there are already solutions for that and one of them is applying a noise, which is dithering.</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">There are many dithering algorithms and you can use whatever you want, I implemented like 5 of them if you wanna try but there are not so noticeable differences, so just use whatever you want.</p>
<div class="image-container my-8"><img src="https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/cloud/ascii_art/david_ascii.png" alt="" width="100%" height="auto" class="object-contain mx-auto"/></div>
<p class="text-base text-zinc-300 my-4 leading-relaxed">the abstract method for different strategies will be something like:</p>
<pre class="rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800"><code class="hljs language-py text-xs"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABC, abstractmethod
<span class="hljs-keyword">from</span> dataclasses <span class="hljs-keyword">import</span> dataclass

<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> numpy.typing <span class="hljs-keyword">as</span> npt


<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DitheringStrategy</span>(<span class="hljs-title class_ inherited__">ABC</span>):
<span class="hljs-meta">    @staticmethod</span>
<span class="hljs-meta">    @abstractmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">dithering</span>(<span class="hljs-params">
        image_array: npt.NDArray[np.float64], quantization_levels: <span class="hljs-built_in">int</span>
    </span>) -&gt; npt.NDArray[np.float64]:
        <span class="hljs-keyword">pass</span>
</code></pre>
<p class="text-base text-zinc-300 my-4 leading-relaxed">and can be loaded with the helper function:</p>
<pre class="rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800"><code class="hljs language-py text-xs"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> lru_cache
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> cast
<span class="hljs-keyword">from</span> importlib <span class="hljs-keyword">import</span> import_module
<span class="hljs-keyword">from</span> ..dithering <span class="hljs-keyword">import</span> DitheringStrategy


<span class="hljs-keyword">class</span> <span class="hljs-title class_">DitheringLoader</span>:
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_module_and_class</span>(<span class="hljs-params">strategy_name: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">tuple</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]:
        module_name = <span class="hljs-string">f&quot;.<span class="hljs-subst">{strategy_name}</span>&quot;</span>

        class_parts = strategy_name.split(<span class="hljs-string">&quot;_&quot;</span>)
        class_name = <span class="hljs-string">f&quot;Dithering<span class="hljs-subst">{<span class="hljs-string">&#x27;&#x27;</span>.join(part.capitalize() <span class="hljs-keyword">for</span> part <span class="hljs-keyword">in</span> class_parts)}</span>&quot;</span>

        <span class="hljs-keyword">return</span> module_name, class_name

<span class="hljs-meta">    @staticmethod</span>
<span class="hljs-meta">    @lru_cache(<span class="hljs-params">maxsize=<span class="hljs-literal">None</span></span>)</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_strategy</span>(<span class="hljs-params">name: <span class="hljs-built_in">str</span></span>) -&gt; DitheringStrategy | <span class="hljs-literal">None</span>:
        <span class="hljs-keyword">try</span>:
            module_name, class_name = DitheringLoader._get_module_and_class(name)
            module = import_module(module_name, package=__package__)
            <span class="hljs-keyword">return</span> cast(DitheringStrategy, <span class="hljs-built_in">getattr</span>(module, class_name))
        <span class="hljs-keyword">except</span> (ImportError, AttributeError):
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_dithering_strategy</span>(<span class="hljs-params">name: <span class="hljs-built_in">str</span></span>) -&gt; DitheringStrategy | <span class="hljs-literal">None</span>:
    <span class="hljs-keyword">return</span> DitheringLoader.get_strategy(name)
</code></pre>
<p class="text-base text-zinc-300 my-4 leading-relaxed">the implementation for <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">floyd-steinberg</code> will be:</p>
<pre class="rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800"><code class="hljs language-py text-xs"><span class="hljs-keyword">from</span> dataclasses <span class="hljs-keyword">import</span> dataclass

<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> numpy.typing <span class="hljs-keyword">as</span> npt
<span class="hljs-keyword">from</span> numba <span class="hljs-keyword">import</span> jit

<span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> DitheringStrategy


<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DitheringFloydSteinberg</span>(<span class="hljs-title class_ inherited__">DitheringStrategy</span>):
    name = <span class="hljs-string">&quot;floyd_steinberg&quot;</span>

<span class="hljs-meta">    @staticmethod</span>
<span class="hljs-meta">    @jit(<span class="hljs-params">
        <span class="hljs-string">&quot;float64[:, :](float64[:, :], int64)&quot;</span>,
        nopython=<span class="hljs-literal">True</span>,
        nogil=<span class="hljs-literal">True</span>,
        fastmath=<span class="hljs-literal">True</span>,
        cache=<span class="hljs-literal">True</span>,
    </span>)</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">dithering</span>(<span class="hljs-params">
        image_array: npt.NDArray[np.float64], quantization_levels: <span class="hljs-built_in">int</span>
    </span>) -&gt; npt.NDArray[np.float64]:
        height: <span class="hljs-built_in">int</span> = image_array.shape[<span class="hljs-number">0</span>]
        width: <span class="hljs-built_in">int</span> = image_array.shape[<span class="hljs-number">1</span>]

        scale: <span class="hljs-built_in">float</span> = <span class="hljs-number">255</span> / (quantization_levels - <span class="hljs-number">1</span>)

        <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):
            <span class="hljs-keyword">for</span> column <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):
                old_pixel = image_array[row, column]
                new_pixel = np.<span class="hljs-built_in">round</span>(old_pixel / scale) * scale
                image_array[row, column] = new_pixel
                error = old_pixel - new_pixel
                <span class="hljs-keyword">if</span> column + <span class="hljs-number">1</span> &lt; width:
                    image_array[row, column + <span class="hljs-number">1</span>] += error * <span class="hljs-number">7</span> / <span class="hljs-number">16</span>
                <span class="hljs-keyword">if</span> row + <span class="hljs-number">1</span> &lt; height <span class="hljs-keyword">and</span> column &gt; <span class="hljs-number">0</span>:
                    image_array[row + <span class="hljs-number">1</span>, column - <span class="hljs-number">1</span>] += error * <span class="hljs-number">3</span> / <span class="hljs-number">16</span>
                <span class="hljs-keyword">if</span> row + <span class="hljs-number">1</span> &lt; height:
                    image_array[row + <span class="hljs-number">1</span>, column] += error * <span class="hljs-number">5</span> / <span class="hljs-number">16</span>
                <span class="hljs-keyword">if</span> row + <span class="hljs-number">1</span> &lt; height <span class="hljs-keyword">and</span> column + <span class="hljs-number">1</span> &lt; width:
                    image_array[row + <span class="hljs-number">1</span>, column + <span class="hljs-number">1</span>] += error * <span class="hljs-number">1</span> / <span class="hljs-number">16</span>
        image_array = np.clip(image_array, <span class="hljs-number">0.0</span>, <span class="hljs-number">255.0</span>)

        <span class="hljs-keyword">return</span> image_array
</code></pre>
<p class="text-base text-zinc-300 my-4 leading-relaxed">and in the <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">process_image</code> just add:</p>
<pre class="rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800"><code class="hljs language-py text-xs">    <span class="hljs-keyword">if</span> dithering_strategy <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
        gray_array = dithering_strategy.dithering(gray_array, <span class="hljs-built_in">len</span>(char_arrays[<span class="hljs-number">0</span>]))
</code></pre>
<h2 class="text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2">Edge detection</h2>
<p class="text-base text-zinc-300 my-4 leading-relaxed">At this point, you already have a nice ascii art generator, but there is a still a thing missing. Edges.</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">It&#x27;s nice that our ascii art can capture color and luminance, but it&#x27;s not telling use about edges, of course originally pixels also didn&#x27;t show us them but it&#x27;s because the original image has a higher resolution than the distorted for the ascii processing, so we need to use some of our ascii characters as edges, sadly we don&#x27;t have many, only: <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">_/|\</code>.</p>
<p class="text-base text-zinc-300 my-4 leading-relaxed">Now the question is, how can we detect edges? Well that&#x27;s an old and popular topic, there are many filters to extract those edges, use difference of gaussians and sobel filter to capture it, with that now you can get the angle of each pixel and then map the angles to our for ascii characters. Replace those characters with the initial ascii art and that&#x27;s it.</p>
<pre class="rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800"><code class="hljs language-py text-xs"><span class="hljs-keyword">from</span> dataclasses <span class="hljs-keyword">import</span> dataclass
<span class="hljs-keyword">import</span> numpy.typing <span class="hljs-keyword">as</span> npt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np


<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">EdgeDetection</span>:
    canny_array: npt.NDArray[np.float64] | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>
    angles: npt.NDArray[np.float64] | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>
    magnitudes: npt.NDArray[np.float64] | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">apply_canny</span>(<span class="hljs-params">self, img_array: npt.NDArray[np.uint8]</span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-keyword">from</span> cv2 <span class="hljs-keyword">import</span> Canny

        <span class="hljs-variable language_">self</span>.canny_array = Canny(img_array, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>).astype(np.float64)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">apply_sobel</span>(<span class="hljs-params">self, dog_array: npt.NDArray[np.float64]</span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-keyword">from</span> modules.edge_detection.sobel <span class="hljs-keyword">import</span> sobel_filter

        <span class="hljs-variable language_">self</span>.angles, <span class="hljs-variable language_">self</span>.magnitudes = sobel_filter(dog_array)
</code></pre>
<p class="text-base text-zinc-300 my-4 leading-relaxed">and the sobel filter:</p>
<pre class="rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800"><code class="hljs language-py text-xs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> numpy.typing <span class="hljs-keyword">as</span> npt

<span class="hljs-keyword">from</span> numba <span class="hljs-keyword">import</span> njit
<span class="hljs-keyword">from</span> cv2 <span class="hljs-keyword">import</span> Sobel, CV_64F


<span class="hljs-meta">@njit(<span class="hljs-params">fastmath=<span class="hljs-literal">True</span>, cache=<span class="hljs-literal">True</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_magnitudes_and_angles</span>(<span class="hljs-params">
    grad_x: npt.NDArray[np.float64],
    grad_y: npt.NDArray[np.float64],
</span>) -&gt; <span class="hljs-built_in">tuple</span>[npt.NDArray[np.float64], npt.NDArray[np.float64]]:
    magnitudes = np.sqrt(grad_x**<span class="hljs-number">2</span> + grad_y**<span class="hljs-number">2</span>)
    max_value = np.<span class="hljs-built_in">max</span>(magnitudes)
    <span class="hljs-keyword">if</span> max_value &gt; <span class="hljs-number">0</span>:
        magnitudes /= max_value
    angles = np.arctan2(grad_y, grad_x) * <span class="hljs-number">180</span> / np.pi
    <span class="hljs-keyword">return</span> angles, magnitudes


<span class="hljs-keyword">def</span> <span class="hljs-title function_">sobel_filter</span>(<span class="hljs-params">
    dog_array: npt.NDArray[np.float64],
</span>) -&gt; <span class="hljs-built_in">tuple</span>[npt.NDArray[np.float64], npt.NDArray[np.float64]]:
    grad_x = Sobel(dog_array, CV_64F, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, ksize=<span class="hljs-number">3</span>)
    grad_y = Sobel(dog_array, CV_64F, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, ksize=<span class="hljs-number">3</span>)

    angles, magnitudes = calculate_magnitudes_and_angles(grad_x, grad_y)

    <span class="hljs-keyword">return</span> angles, magnitudes
</code></pre>
<p class="text-base text-zinc-300 my-4 leading-relaxed">so in the <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">process_image</code>, add:</p>
<pre class="rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800"><code class="hljs language-py text-xs">    edge_detection_parameters: EdgeDetection = EdgeDetection()
    <span class="hljs-keyword">if</span> edge_detection:
        edge_detection_parameters.apply_canny(image)
        edge_detection_parameters.apply_sobel(gray_array)
</code></pre>
<h2 class="text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2">Color correction</h2>
<p class="text-base text-zinc-300 my-4 leading-relaxed">Even if we apply the best possible ascii replacement for the pixels, the image will still contain some pixels from the background color, in this case, it&#x27;s black; it makes that the ascii art image to looks darker. To improve this, we can apply some enhancements to the colors of the ascii image, for that I&#x27;ve implemented some post processing strategies: <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">brightness</code>, <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">contrast</code>, <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">exposure</code> and <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">saturation</code>.</p>
<pre class="rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800"><code class="hljs language-py text-xs"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABC, abstractmethod
<span class="hljs-keyword">from</span> dataclasses <span class="hljs-keyword">import</span> dataclass
<span class="hljs-keyword">from</span> enum <span class="hljs-keyword">import</span> Enum

<span class="hljs-keyword">from</span> numpy <span class="hljs-keyword">import</span> uint8
<span class="hljs-keyword">from</span> numpy.typing <span class="hljs-keyword">import</span> NDArray


<span class="hljs-keyword">class</span> <span class="hljs-title class_">PostProcessingStrategyName</span>(<span class="hljs-title class_ inherited__">Enum</span>):
    BRIGHTNESS = <span class="hljs-string">&quot;brightness&quot;</span>
    CONTRAST = <span class="hljs-string">&quot;contrast&quot;</span>
    EXPOSURE = <span class="hljs-string">&quot;exposure&quot;</span>
    SATURATION = <span class="hljs-string">&quot;saturation&quot;</span>


<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PostProcessingStrategy</span>(<span class="hljs-title class_ inherited__">ABC</span>):
    name: PostProcessingStrategyName

<span class="hljs-meta">    @abstractmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">apply</span>(<span class="hljs-params">self, image: NDArray[uint8], value: <span class="hljs-built_in">float</span></span>) -&gt; NDArray[uint8]:
        <span class="hljs-string">&quot;&quot;&quot;Apply a post-processing effect to an image.

        Args:
            image: The input image as a NumPy array (BGR format).
            value: The intensity of the effect.

        Returns:
            The processed image as a NumPy array.

        &quot;&quot;&quot;</span>
</code></pre>
<p class="text-base text-zinc-300 my-4 leading-relaxed">then you can load them using a helper function:</p>
<pre class="rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800"><code class="hljs language-py text-xs"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> cache
<span class="hljs-keyword">from</span> importlib <span class="hljs-keyword">import</span> import_module
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> cast

<span class="hljs-keyword">from</span> numpy <span class="hljs-keyword">import</span> uint8
<span class="hljs-keyword">from</span> numpy.typing <span class="hljs-keyword">import</span> NDArray

<span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> PostProcessingStrategy


<span class="hljs-keyword">class</span> <span class="hljs-title class_">PostProcessingLoader</span>:
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_module_and_class</span>(<span class="hljs-params">strategy_name: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">tuple</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]:
        module_name: <span class="hljs-built_in">str</span> = <span class="hljs-string">f&quot;.<span class="hljs-subst">{strategy_name}</span>&quot;</span>
        class_name: <span class="hljs-built_in">str</span> = strategy_name.capitalize()
        <span class="hljs-keyword">return</span> module_name, class_name

<span class="hljs-meta">    @staticmethod</span>
<span class="hljs-meta">    @cache</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_strategy</span>(<span class="hljs-params">name: <span class="hljs-built_in">str</span></span>) -&gt; PostProcessingStrategy | <span class="hljs-literal">None</span>:
        <span class="hljs-keyword">try</span>:
            module_name, class_name = PostProcessingLoader._get_module_and_class(name)
            module = import_module(module_name, package=__package__)
            strategy_class = <span class="hljs-built_in">getattr</span>(module, class_name)
            <span class="hljs-keyword">return</span> cast(<span class="hljs-string">&quot;PostProcessingStrategy&quot;</span>, strategy_class())
        <span class="hljs-keyword">except</span> (ImportError, AttributeError):
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_post_processing_strategy</span>(<span class="hljs-params">name: <span class="hljs-built_in">str</span></span>) -&gt; PostProcessingStrategy | <span class="hljs-literal">None</span>:
    <span class="hljs-keyword">return</span> PostProcessingLoader.get_strategy(name)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">apply_post_processing</span>(<span class="hljs-params">image: NDArray[uint8]</span>) -&gt; NDArray[uint8]:
    post_processing_parameters: <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">float</span>] = {
        <span class="hljs-string">&quot;brightness&quot;</span>: <span class="hljs-number">6.0</span>,
        <span class="hljs-string">&quot;contrast&quot;</span>: <span class="hljs-number">1.28</span>,
        <span class="hljs-string">&quot;saturation&quot;</span>: <span class="hljs-number">1.22</span>,
        <span class="hljs-string">&quot;exposure&quot;</span>: <span class="hljs-number">1.18</span>,
    }

    <span class="hljs-keyword">for</span> filter_name, value <span class="hljs-keyword">in</span> post_processing_parameters.items():
        filter_strategy: PostProcessingStrategy | <span class="hljs-literal">None</span> = get_post_processing_strategy(
            filter_name,
        )
        <span class="hljs-keyword">if</span> filter_strategy:
            image = filter_strategy.apply(image, value)
    <span class="hljs-keyword">return</span> image
</code></pre>
<h2 class="text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2">Further</h2>
<p class="text-base text-zinc-300 my-4 leading-relaxed">I&#x27;ve just explained what to do, and not exactly how to do, and that&#x27;s because in the implementation is the joyness of this. Try to do the optimizations for yourself, be aware that despite python could be a good idea because of the libraries for image processing, it&#x27;s really slow, it could work fast for images but you will suffer in videos.</p></div></div></article></div></main><footer class="border-t border-zinc-800 py-6 mt-12"><div class="container mx-auto px-4 relative h-full"><div class="grid grid-cols-1 md:grid-cols-2 gap-8"><div><h3 class="text-lg font-semibold text-white mb-4">Connect</h3><div class="flex space-x-4"><a href="https://github.com/HeNeos" target="_blank" rel="noopener noreferrer" class="text-slate-400 hover:text-white transition-colors">GitHub</a><a href="https://x.com/_HeNeos" target="_blank" rel="noopener noreferrer" class="text-slate-400 hover:text-white transition-colors">X</a><a href="https://codeforces.com/profile/HeNeos" target="_blank" rel="noopener noreferrer" class="text-slate-400 hover:text-white transition-colors">Codeforces</a><a href="https://codeforces.com/profile/Ptolemy_314" target="_blank" rel="noopener noreferrer" class="text-slate-400 hover:text-white transition-colors">Codeforces old</a></div></div><div><h4 class="text-lg font-semibold text-white mb-4">Project Euler</h4><a href="https://projecteuler.net/profile/HeNeos.png" target="_blank" rel="noopener noreferrer"><img src="https://projecteuler.net/profile/HeNeos.png" alt="Project Euler Profile" class=" h-auto max-h-10 rounded-sm object-contain"/></a></div></div></div></footer><script src="/heneos-blog/_next/static/chunks/webpack-f5e2af5b5e96ca99.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[8173,[\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-4374ee6693381f28.js\"],\"\"]\n3:I[5244,[],\"\"]\n4:I[3866,[],\"\"]\n5:I[6213,[],\"OutletBoundary\"]\n8:I[6213,[],\"ViewportBoundary\"]\na:I[6213,[],\"MetadataBoundary\"]\nc:I[4835,[],\"\"]\n:HL[\"/heneos-blog/_next/static/css/10c5481d6c776747.css\",\"style\"]\n:HL[\"/heneos-blog/_next/static/css/31789995b2727dcb.css\",\"style\"]\n:HL[\"/heneos-blog/_next/static/css/5eacd01f773eed7f.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"nOSw8IjKGyIq4lZCDLkWG\",\"p\":\"/heneos-blog\",\"c\":[\"\",\"blog\",\"2025-01-18-cloud-ascii-art\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"2025-01-18-cloud-ascii-art\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/heneos-blog/_next/static/css/10c5481d6c776747.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/heneos-blog/_next/static/css/31789995b2727dcb.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"bg-zinc-950 text-zinc-100 min-h-screen\",\"children\":[[\"$\",\"header\",null,{\"className\":\"p-6 border-b border-zinc-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-6xl mx-auto\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-10\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-6xl font-raleway tracking-tighter mb-2 text-center\",\"children\":\"HeNeos blog\"}],[\"$\",\"p\",null,{\"className\":\"text-xl font-mono text-center text-zinc-500 mb-1\",\"children\":\"Josue H. @ JP Morgan Chase\"}],[\"$\",\"p\",null,{\"className\":\"text-xl font-raleway text-center text-zinc-600\",\"children\":\"HeNeos\"}]]}],[\"$\",\"div\",null,{\"className\":\"flex justify-center space-x-20 mb-4\",\"children\":[[\"$\",\"$L2\",null,{\"href\":\"https://github.com/HeNeos\",\"target\":\"_blank\",\"className\":\"text-base font-raleway text-zinc-500 hover:text-accent animated-underline\",\"children\":\"GitHub\"}],[\"$\",\"$L2\",null,{\"href\":\"https://www.linkedin.com/in/heneos\",\"target\":\"_blank\",\"className\":\"text-base font-raleway text-zinc-500 hover:text-accent animated-underline\",\"children\":\"LinkedIn\"}],[\"$\",\"$L2\",null,{\"href\":\"mailto:he.neos@outlook.com\",\"className\":\"text-base font-raleway text-zinc-500 hover:text-accent animated-underline\",\"children\":\"Email\"}]]}],[\"$\",\"div\",null,{\"className\":\"text-xl font-raleway flex flex-col sm:flex-row justify-center gap-4 border-t border-zinc-800 pt-4\",\"children\":[[\"$\",\"$L2\",null,{\"href\":\"/\",\"children\":[\"$\",\"div\",null,{\"className\":\"cursor-pointer hover:bg-gray-200 hover:text-zinc-900 transition-colors px-4 py-2 rounded-md flex items-center justify-between\",\"children\":[[\"$\",\"span\",null,{\"children\":\"Home\"}],[\"$\",\"span\",null,{\"className\":\"text-zinc-500 ml-6\",\"children\":\"ha\"}]]}]}],[\"$\",\"$L2\",null,{\"href\":\"/blog\",\"children\":[\"$\",\"div\",null,{\"className\":\"cursor-pointer hover:bg-gray-200 hover:text-zinc-900 transition-colors px-4 py-2 rounded-md flex items-center justify-between\",\"children\":[[\"$\",\"span\",null,{\"children\":\"Blog\"}],[\"$\",\"span\",null,{\"className\":\"text-zinc-500 ml-6\",\"children\":\"hb\"}]]}]}],[\"$\",\"$L2\",null,{\"href\":\"/about\",\"children\":[\"$\",\"div\",null,{\"className\":\"cursor-pointer hover:bg-gray-200 hover:text-zinc-900 transition-colors px-4 py-2 rounded-md flex items-center justify-between\",\"children\":[[\"$\",\"span\",null,{\"children\":\"About\"}],[\"$\",\"span\",null,{\"className\":\"text-zinc-500 ml-6\",\"children\":\"hc\"}]]}]}]]}]]}]}],[\"$\",\"main\",null,{\"className\":\"container mx-auto px-4 py-8 max-w-5xl\",\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"$undefined\",[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"border-t border-zinc-800 py-6 mt-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"container mx-auto px-4 relative h-full\",\"children\":[\"$\",\"div\",null,{\"className\":\"grid grid-cols-1 md:grid-cols-2 gap-8\",\"children\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"h3\",null,{\"className\":\"text-lg font-semibold text-white mb-4\",\"children\":\"Connect\"}],[\"$\",\"div\",null,{\"className\":\"flex space-x-4\",\"children\":[[\"$\",\"a\",null,{\"href\":\"https://github.com/HeNeos\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-slate-400 hover:text-white transition-colors\",\"children\":\"GitHub\"}],[\"$\",\"a\",null,{\"href\":\"https://x.com/_HeNeos\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-slate-400 hover:text-white transition-colors\",\"children\":\"X\"}],[\"$\",\"a\",null,{\"href\":\"https://codeforces.com/profile/HeNeos\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-slate-400 hover:text-white transition-colors\",\"children\":\"Codeforces\"}],[\"$\",\"a\",null,{\"href\":\"https://codeforces.com/profile/Ptolemy_314\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-slate-400 hover:text-white transition-colors\",\"children\":\"Codeforces old\"}]]}]]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"h4\",null,{\"className\":\"text-lg font-semibold text-white mb-4\",\"children\":\"Project Euler\"}],[\"$\",\"a\",null,{\"href\":\"https://projecteuler.net/profile/HeNeos.png\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"children\":[\"$\",\"img\",null,{\"src\":\"https://projecteuler.net/profile/HeNeos.png\",\"alt\":\"Project Euler Profile\",\"className\":\" h-auto max-h-10 rounded-sm object-contain\"}]}]]}]]}]}]}]]}]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"2025-01-18-cloud-ascii-art\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[[\"$\",\"div\",null,{\"className\":\"max-w-5xl mx-auto\",\"children\":[[\"$\",\"$L2\",null,{\"href\":\"/blog\",\"className\":\"text-zinc-500 hover:text-blue-400 mb-6 inline-block animated-underline\",\"children\":\"‚Üê Back to all posts\"}],[\"$\",\"article\",null,{\"className\":\"border border-zinc-800 rounded-lg p-4 bg-zinc-900/30\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-8 border-b border-zinc-800 pb-6\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-3xl font-bold mb-4 gradient-text\",\"children\":\"Ascii Art\"}],[\"$\",\"p\",null,{\"className\":\"text-zinc-500 mb-4 font-mono\",\"children\":\"January 18, 2025\"}],[\"$\",\"div\",null,{\"className\":\"flex gap-2 flex-wrap\",\"children\":[[\"$\",\"span\",\"cloud\",{\"className\":\"inline-block bg-zinc-800 text-zinc-300 px-2 py-1 text-xs rounded-sm\",\"children\":[\"#\",\"cloud\"]}],[\"$\",\"span\",\"image-processing\",{\"className\":\"inline-block bg-zinc-800 text-zinc-300 px-2 py-1 text-xs rounded-sm\",\"children\":[\"#\",\"image-processing\"]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"gap-4 mt-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"prose prose-invert prose-zinc max-w-none\",\"children\":[[\"$\",\"p\",\"p-0\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"I've been inactive on writing for a long time, many thins happened. I'm also now AWS SysOps certified, it went better than I thought. Anyway, let's start with the topic of this entry.\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"I've been working for several months on ascii art, just as a quick introduction to it, ascii art is the process to represent images with ascii characters. You may be wondering how is that possible?, if you think about images, you will remember that it's compound of pixels, a lot of them, if instead of pixels we replace them with ascii characters, would it work?... Yes, but no.\"}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"It's the basic idea, but we are gonna deep dive more into this, otherwise I had not been doing that for several months.\"}],\"\\n\",[\"$\",\"div\",\"img-0\",{\"className\":\"image-container my-8\",\"children\":[\"$\",\"img\",null,{\"src\":\"https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/cloud/ascii_art/ascii_art_ascii.png\",\"alt\":\"ASCII Art\",\"width\":\"100%\",\"height\":\"auto\",\"className\":\"object-contain mx-auto\"}]}],\"\\n\",[\"$\",\"h2\",\"h2-0\",{\"className\":\"text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2\",\"children\":\"Basic ascii art\"}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"Let's start with the basic idea, and then go further from it. If we replace every pixel with a character, the first question is to which character?, how is possible to map every possible pixel (24 bits) to a character (8 bits)?\"}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":[\"Let's think for a moment only for a grayscale image, then instead there are only 256 possible pixels, which is much less than \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"2\"}],[\"$\",\"mn\",\"mn-1\",{\"children\":\"24\"}]]}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"2^{24}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8141em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"2\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.8141em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-3.063em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":\"24\"}]}]}]]}]}]}]}]}]]}]]}]}]]}],\". Now, how can we assign a character to a pixel value? Well, not all ascii characters covers the screen in the same \",[\"$\",\"em\",\"em-0\",{\"children\":\"intensity\"}],\", for example, compare this character \",[\"$\",\"code\",\"code-0\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"-\"}],\" with \",[\"$\",\"code\",\"code-1\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"@\"}],\", so it makes sense so to assign the characters that less cover the screen with the lowest values in the grayscale (the darker colors) and the brighter pixels with something like \",[\"$\",\"code\",\"code-2\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"@\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"We have another problem here, despite there are 256 ascii characters, not all of them are printable. However, this is easy to solve, just define ranges where each printable ascii character should map to a grayscale value, you can decide if make this scale linear or not.\"}],\"\\n\",[\"$\",\"p\",\"p-6\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"And that's it, now you have a way to put ascii characters instead of pixels, so we are done, right? Not really, it's true that now we replaced every character with a pixel and that should work but, a printed ascii character doesn't have the dimensions of a pixel, it depends about the fontsize but in almost all cases, the aspect ratio for a character is not 1:1, it means if you replace every pixel with a character you will see a deformed image, to solve this, easy way is to first modify aspect ratio of the original image, according to your font size, in most cases doubling the width should be enough as a good approximation.\"}],\"\\n\",[\"$\",\"p\",\"p-7\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"We have another problem, our output image resolution is too big, why? Well, since we discussed before, a character doesn't have the same size as a pixel and depending of your font size it could be bigger, imagine for example if your font takes 12 pixels as height and 8 and width, if you did the rescale to preserve the original aspect ratio of the image then now your output image will be 144 times bigger than before. To solve this issue, you can just downscale the image, reduce the original size so that the output image despite of being multiplied by 144 is still manageable.\"}],\"\\n\",[\"$\",\"p\",\"p-8\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":[\"We've now solved how to do the ascii art for grayscale images, but not all images are grayscale, most of them are in color, so what can we do? Easy, convert them to grayscale, or use this formula \",[\"$\",\"code\",\"code-0\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"0.299 Red + 0.587 Green + 0.114 Blue\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-9\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"And that's it, it covers a basic ascii art that you can find around the internet.\"}],\"\\n\",[\"$\",\"div\",\"img-1\",{\"className\":\"image-container my-8\",\"children\":[\"$\",\"img\",null,{\"src\":\"https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/cloud/ascii_art/heneos_ascii.png\",\"alt\":\"\",\"width\":\"80%\",\"height\":\"auto\",\"className\":\"object-contain mx-auto\"}]}],\"\\n\",[\"$\",\"h2\",\"h2-1\",{\"className\":\"text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2\",\"children\":\"Colored ascii art\"}],\"\\n\",[\"$\",\"p\",\"p-10\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":[\"At this point, you're able to have ascii art from any image preserving the aspect ratio and the size, but you notice an issue, most of the details are lost because even when ascii characters can show the \",[\"$\",\"code\",\"code-0\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"luminance\"}],\" of the original image, they're not able to show the \",[\"$\",\"code\",\"code-1\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"color\"}],\", so how to solve this?\"]}],\"\\n\",[\"$\",\"p\",\"p-11\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"Instead of printing the ascii character on a text based display, you can print it on a canvas or a created image, then you will have an image with tons of ascii characters that represents your original image. This concept will help us later when we wanna do videos.\"}],\"\\n\",[\"$\",\"p\",\"p-12\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"In a canvas, you can select to which color you want to print your ascii character, since you already know the height and width of your font, you also know how to moves over the canvas.\"}],\"\\n\",[\"$\",\"div\",\"img-2\",{\"className\":\"image-container my-8\",\"children\":[\"$\",\"img\",null,{\"src\":\"https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/cloud/ascii_art/jaden_ascii.png\",\"alt\":\"\",\"width\":\"80%\",\"height\":\"auto\",\"className\":\"object-contain mx-auto\"}]}],\"\\n\",[\"$\",\"pre\",\"pre-0\",{\"className\":\"rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-py text-xs\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-title function_\",\"children\":\"process_image\"}],\"(\",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-params\",\"children\":[\"\\n    image: npt.NDArray[np.uint8],\\n    char_arrays: \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-built_in\",\"children\":\"list\"}],\"[npt.NDArray[np.str_]],\\n\"]}],\") -\u003e \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-built_in\",\"children\":\"tuple\"}],\"[\",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-built_in\",\"children\":\"list\"}],\"[AsciiImage], AsciiColors, npt.NDArray[np.float64]]:\\n\\n    \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-comment\",\"children\":\"# custom grayscale\"}],\"\\n    gray_array: npt.NDArray[np.float64] = np.clip(\\n        np.dot(image[..., :\",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-number\",\"children\":\"3\"}],\"], [\",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-number\",\"children\":\"0.3090\"}],\", \",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-number\",\"children\":\"0.5670\"}],\", \",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-number\",\"children\":\"0.1240\"}],\"]), \",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-number\",\"children\":\"0.0\"}],\", \",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-number\",\"children\":\"255.0\"}],\"\\n    )\\n\\n    ascii_chars: \",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-built_in\",\"children\":\"list\"}],\"[npt.NDArray[np.str_]] = [\\n        map_to_char_vectorized(gray_array, char_array)\\n        \",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-keyword\",\"children\":\"for\"}],\" char_array \",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-keyword\",\"children\":\"in\"}],\" char_arrays\\n    ]\\n\\n    grids: \",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-built_in\",\"children\":\"list\"}],\"[AsciiImage] = [ascii_char.tolist() \",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-keyword\",\"children\":\"for\"}],\" ascii_char \",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-keyword\",\"children\":\"in\"}],\" ascii_chars]\\n    image_colors: AsciiColors = [row.tolist() \",[\"$\",\"span\",\"span-18\",{\"className\":\"hljs-keyword\",\"children\":\"for\"}],\" row \",[\"$\",\"span\",\"span-19\",{\"className\":\"hljs-keyword\",\"children\":\"in\"}],\" image]\\n\\n    \",[\"$\",\"span\",\"span-20\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" grids, image_colors, gray_array\\n\"]}]}],\"\\n\",[\"$\",\"h2\",\"h2-2\",{\"className\":\"text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2\",\"children\":\"Video processing\"}],\"\\n\",[\"$\",\"p\",\"p-13\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"Now, instead of processing an image, we're going to process a video, this step is fairly simple since this could be summarized as just applying the same idea to all frames and then merge them again.\"}],\"\\n\",[\"$\",\"p\",\"p-14\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"It's good but take into account two things, a video is commonly compressed to save storage with a lower bitrate. Merging all created images with our ascii art will create a heavy video if you don't apply the appropiate compression.\"}],\"\\n\",[\"$\",\"p\",\"p-15\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"For all of this stuff related with videos, I recommend to use ffmpeg and create your own small set of functions that call to ffmpeg, you're gonna need it to resize the video, to split/merge frames and to extract/add the audio.\"}],\"\\n\",[\"$\",\"h2\",\"h2-3\",{\"className\":\"text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2\",\"children\":\"Dithering\"}],\"\\n\",[\"$\",\"p\",\"p-16\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"You've probably notices on your videos those ugly color bands. It's just disgusting... it's happening because our character space is not as big as the original pixel one. Hopefully, there are already solutions for that and one of them is applying a noise, which is dithering.\"}],\"\\n\",[\"$\",\"p\",\"p-17\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"There are many dithering algorithms and you can use whatever you want, I implemented like 5 of them if you wanna try but there are not so noticeable differences, so just use whatever you want.\"}],\"\\n\",[\"$\",\"div\",\"img-3\",{\"className\":\"image-container my-8\",\"children\":[\"$\",\"img\",null,{\"src\":\"https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/cloud/ascii_art/david_ascii.png\",\"alt\":\"\",\"width\":\"100%\",\"height\":\"auto\",\"className\":\"object-contain mx-auto\"}]}],\"\\n\",[\"$\",\"p\",\"p-18\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"the abstract method for different strategies will be something like:\"}],\"\\n\",[\"$\",\"pre\",\"pre-1\",{\"className\":\"rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-py text-xs\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" abc \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" ABC, abstractmethod\\n\",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" dataclasses \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" dataclass\\n\\n\",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" numpy \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-keyword\",\"children\":\"as\"}],\" np\\n\",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" numpy.typing \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-keyword\",\"children\":\"as\"}],\" npt\\n\\n\\n\",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-meta\",\"children\":\"@dataclass\"}],\"\\n\",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-title class_\",\"children\":\"DitheringStrategy\"}],\"(\",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-title class_ inherited__\",\"children\":\"ABC\"}],\"):\\n\",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-meta\",\"children\":\"    @staticmethod\"}],\"\\n\",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-meta\",\"children\":\"    @abstractmethod\"}],\"\\n    \",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-title function_\",\"children\":\"dithering\"}],\"(\",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-params\",\"children\":[\"\\n        image_array: npt.NDArray[np.float64], quantization_levels: \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-built_in\",\"children\":\"int\"}],\"\\n    \"]}],\") -\u003e npt.NDArray[np.float64]:\\n        \",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-keyword\",\"children\":\"pass\"}],\"\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-19\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"and can be loaded with the helper function:\"}],\"\\n\",[\"$\",\"pre\",\"pre-2\",{\"className\":\"rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-py text-xs\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" functools \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" lru_cache\\n\",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" typing \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" cast\\n\",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" importlib \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" import_module\\n\",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" ..dithering \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" DitheringStrategy\\n\\n\\n\",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-title class_\",\"children\":\"DitheringLoader\"}],\":\\n\",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-meta\",\"children\":\"    @staticmethod\"}],\"\\n    \",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-title function_\",\"children\":\"_get_module_and_class\"}],\"(\",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-params\",\"children\":[\"strategy_name: \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-built_in\",\"children\":\"str\"}]]}],\") -\u003e \",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-built_in\",\"children\":\"tuple\"}],\"[\",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-built_in\",\"children\":\"str\"}],\", \",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-built_in\",\"children\":\"str\"}],\"]:\\n        module_name = \",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-string\",\"children\":[\"f\\\".\",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-subst\",\"children\":\"{strategy_name}\"}],\"\\\"\"]}],\"\\n\\n        class_parts = strategy_name.split(\",[\"$\",\"span\",\"span-18\",{\"className\":\"hljs-string\",\"children\":\"\\\"_\\\"\"}],\")\\n        class_name = \",[\"$\",\"span\",\"span-19\",{\"className\":\"hljs-string\",\"children\":[\"f\\\"Dithering\",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-subst\",\"children\":[\"{\",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-string\",\"children\":\"''\"}],\".join(part.capitalize() \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"for\"}],\" part \",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-keyword\",\"children\":\"in\"}],\" class_parts)}\"]}],\"\\\"\"]}],\"\\n\\n        \",[\"$\",\"span\",\"span-20\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" module_name, class_name\\n\\n\",[\"$\",\"span\",\"span-21\",{\"className\":\"hljs-meta\",\"children\":\"    @staticmethod\"}],\"\\n\",[\"$\",\"span\",\"span-22\",{\"className\":\"hljs-meta\",\"children\":[\"    @lru_cache(\",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-params\",\"children\":[\"maxsize=\",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-literal\",\"children\":\"None\"}]]}],\")\"]}],\"\\n    \",[\"$\",\"span\",\"span-23\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-24\",{\"className\":\"hljs-title function_\",\"children\":\"get_strategy\"}],\"(\",[\"$\",\"span\",\"span-25\",{\"className\":\"hljs-params\",\"children\":[\"name: \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-built_in\",\"children\":\"str\"}]]}],\") -\u003e DitheringStrategy | \",[\"$\",\"span\",\"span-26\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\":\\n        \",[\"$\",\"span\",\"span-27\",{\"className\":\"hljs-keyword\",\"children\":\"try\"}],\":\\n            module_name, class_name = DitheringLoader._get_module_and_class(name)\\n            module = import_module(module_name, package=__package__)\\n            \",[\"$\",\"span\",\"span-28\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" cast(DitheringStrategy, \",[\"$\",\"span\",\"span-29\",{\"className\":\"hljs-built_in\",\"children\":\"getattr\"}],\"(module, class_name))\\n        \",[\"$\",\"span\",\"span-30\",{\"className\":\"hljs-keyword\",\"children\":\"except\"}],\" (ImportError, AttributeError):\\n            \",[\"$\",\"span\",\"span-31\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",\"span-32\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\"\\n\\n\\n\",[\"$\",\"span\",\"span-33\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-34\",{\"className\":\"hljs-title function_\",\"children\":\"get_dithering_strategy\"}],\"(\",[\"$\",\"span\",\"span-35\",{\"className\":\"hljs-params\",\"children\":[\"name: \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-built_in\",\"children\":\"str\"}]]}],\") -\u003e DitheringStrategy | \",[\"$\",\"span\",\"span-36\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\":\\n    \",[\"$\",\"span\",\"span-37\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" DitheringLoader.get_strategy(name)\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-20\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":[\"the implementation for \",[\"$\",\"code\",\"code-0\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"floyd-steinberg\"}],\" will be:\"]}],\"\\n\",[\"$\",\"pre\",\"pre-3\",{\"className\":\"rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-py text-xs\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" dataclasses \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" dataclass\\n\\n\",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" numpy \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-keyword\",\"children\":\"as\"}],\" np\\n\",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" numpy.typing \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-keyword\",\"children\":\"as\"}],\" npt\\n\",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" numba \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" jit\\n\\n\",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" . \",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" DitheringStrategy\\n\\n\\n\",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-meta\",\"children\":\"@dataclass\"}],\"\\n\",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-title class_\",\"children\":\"DitheringFloydSteinberg\"}],\"(\",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-title class_ inherited__\",\"children\":\"DitheringStrategy\"}],\"):\\n    name = \",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-string\",\"children\":\"\\\"floyd_steinberg\\\"\"}],\"\\n\\n\",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-meta\",\"children\":\"    @staticmethod\"}],\"\\n\",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-meta\",\"children\":[\"    @jit(\",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-params\",\"children\":[\"\\n        \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-string\",\"children\":\"\\\"float64[:, :](float64[:, :], int64)\\\"\"}],\",\\n        nopython=\",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-literal\",\"children\":\"True\"}],\",\\n        nogil=\",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-literal\",\"children\":\"True\"}],\",\\n        fastmath=\",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-literal\",\"children\":\"True\"}],\",\\n        cache=\",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-literal\",\"children\":\"True\"}],\",\\n    \"]}],\")\"]}],\"\\n    \",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-18\",{\"className\":\"hljs-title function_\",\"children\":\"dithering\"}],\"(\",[\"$\",\"span\",\"span-19\",{\"className\":\"hljs-params\",\"children\":[\"\\n        image_array: npt.NDArray[np.float64], quantization_levels: \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-built_in\",\"children\":\"int\"}],\"\\n    \"]}],\") -\u003e npt.NDArray[np.float64]:\\n        height: \",[\"$\",\"span\",\"span-20\",{\"className\":\"hljs-built_in\",\"children\":\"int\"}],\" = image_array.shape[\",[\"$\",\"span\",\"span-21\",{\"className\":\"hljs-number\",\"children\":\"0\"}],\"]\\n        width: \",[\"$\",\"span\",\"span-22\",{\"className\":\"hljs-built_in\",\"children\":\"int\"}],\" = image_array.shape[\",[\"$\",\"span\",\"span-23\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"]\\n\\n        scale: \",[\"$\",\"span\",\"span-24\",{\"className\":\"hljs-built_in\",\"children\":\"float\"}],\" = \",[\"$\",\"span\",\"span-25\",{\"className\":\"hljs-number\",\"children\":\"255\"}],\" / (quantization_levels - \",[\"$\",\"span\",\"span-26\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\")\\n\\n        \",[\"$\",\"span\",\"span-27\",{\"className\":\"hljs-keyword\",\"children\":\"for\"}],\" row \",[\"$\",\"span\",\"span-28\",{\"className\":\"hljs-keyword\",\"children\":\"in\"}],\" \",[\"$\",\"span\",\"span-29\",{\"className\":\"hljs-built_in\",\"children\":\"range\"}],\"(height):\\n            \",[\"$\",\"span\",\"span-30\",{\"className\":\"hljs-keyword\",\"children\":\"for\"}],\" column \",[\"$\",\"span\",\"span-31\",{\"className\":\"hljs-keyword\",\"children\":\"in\"}],\" \",[\"$\",\"span\",\"span-32\",{\"className\":\"hljs-built_in\",\"children\":\"range\"}],\"(width):\\n                old_pixel = image_array[row, column]\\n                new_pixel = np.\",[\"$\",\"span\",\"span-33\",{\"className\":\"hljs-built_in\",\"children\":\"round\"}],\"(old_pixel / scale) * scale\\n                image_array[row, column] = new_pixel\\n                error = old_pixel - new_pixel\\n                \",[\"$\",\"span\",\"span-34\",{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" column + \",[\"$\",\"span\",\"span-35\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\" \u003c width:\\n                    image_array[row, column + \",[\"$\",\"span\",\"span-36\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"] += error * \",[\"$\",\"span\",\"span-37\",{\"className\":\"hljs-number\",\"children\":\"7\"}],\" / \",[\"$\",\"span\",\"span-38\",{\"className\":\"hljs-number\",\"children\":\"16\"}],\"\\n                \",[\"$\",\"span\",\"span-39\",{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" row + \",[\"$\",\"span\",\"span-40\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\" \u003c height \",[\"$\",\"span\",\"span-41\",{\"className\":\"hljs-keyword\",\"children\":\"and\"}],\" column \u003e \",[\"$\",\"span\",\"span-42\",{\"className\":\"hljs-number\",\"children\":\"0\"}],\":\\n                    image_array[row + \",[\"$\",\"span\",\"span-43\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\", column - \",[\"$\",\"span\",\"span-44\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"] += error * \",[\"$\",\"span\",\"span-45\",{\"className\":\"hljs-number\",\"children\":\"3\"}],\" / \",[\"$\",\"span\",\"span-46\",{\"className\":\"hljs-number\",\"children\":\"16\"}],\"\\n                \",[\"$\",\"span\",\"span-47\",{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" row + \",[\"$\",\"span\",\"span-48\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\" \u003c height:\\n                    image_array[row + \",[\"$\",\"span\",\"span-49\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\", column] += error * \",[\"$\",\"span\",\"span-50\",{\"className\":\"hljs-number\",\"children\":\"5\"}],\" / \",[\"$\",\"span\",\"span-51\",{\"className\":\"hljs-number\",\"children\":\"16\"}],\"\\n                \",[\"$\",\"span\",\"span-52\",{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" row + \",[\"$\",\"span\",\"span-53\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\" \u003c height \",[\"$\",\"span\",\"span-54\",{\"className\":\"hljs-keyword\",\"children\":\"and\"}],\" column + \",[\"$\",\"span\",\"span-55\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\" \u003c width:\\n                    image_array[row + \",[\"$\",\"span\",\"span-56\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\", column + \",[\"$\",\"span\",\"span-57\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"] += error * \",[\"$\",\"span\",\"span-58\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\" / \",[\"$\",\"span\",\"span-59\",{\"className\":\"hljs-number\",\"children\":\"16\"}],\"\\n        image_array = np.clip(image_array, \",[\"$\",\"span\",\"span-60\",{\"className\":\"hljs-number\",\"children\":\"0.0\"}],\", \",[\"$\",\"span\",\"span-61\",{\"className\":\"hljs-number\",\"children\":\"255.0\"}],\")\\n\\n        \",[\"$\",\"span\",\"span-62\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" image_array\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-21\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":[\"and in the \",[\"$\",\"code\",\"code-0\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"process_image\"}],\" just add:\"]}],\"\\n\",[\"$\",\"pre\",\"pre-4\",{\"className\":\"rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-py text-xs\",\"children\":[\"    \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" dithering_strategy \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"is\"}],\" \",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-keyword\",\"children\":\"not\"}],\" \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\":\\n        gray_array = dithering_strategy.dithering(gray_array, \",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-built_in\",\"children\":\"len\"}],\"(char_arrays[\",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-number\",\"children\":\"0\"}],\"]))\\n\"]}]}],\"\\n\",[\"$\",\"h2\",\"h2-4\",{\"className\":\"text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2\",\"children\":\"Edge detection\"}],\"\\n\",[\"$\",\"p\",\"p-22\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"At this point, you already have a nice ascii art generator, but there is a still a thing missing. Edges.\"}],\"\\n\",[\"$\",\"p\",\"p-23\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":[\"It's nice that our ascii art can capture color and luminance, but it's not telling use about edges, of course originally pixels also didn't show us them but it's because the original image has a higher resolution than the distorted for the ascii processing, so we need to use some of our ascii characters as edges, sadly we don't have many, only: \",[\"$\",\"code\",\"code-0\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"_/|\\\\\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-24\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"Now the question is, how can we detect edges? Well that's an old and popular topic, there are many filters to extract those edges, use difference of gaussians and sobel filter to capture it, with that now you can get the angle of each pixel and then map the angles to our for ascii characters. Replace those characters with the initial ascii art and that's it.\"}],\"\\n\",[\"$\",\"pre\",\"pre-5\",{\"className\":\"rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-py text-xs\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" dataclasses \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" dataclass\\n\",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" numpy.typing \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-keyword\",\"children\":\"as\"}],\" npt\\n\",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" numpy \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-keyword\",\"children\":\"as\"}],\" np\\n\\n\\n\",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-meta\",\"children\":\"@dataclass\"}],\"\\n\",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-title class_\",\"children\":\"EdgeDetection\"}],\":\\n    canny_array: npt.NDArray[np.float64] | \",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\" = \",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\"\\n    angles: npt.NDArray[np.float64] | \",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\" = \",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\"\\n    magnitudes: npt.NDArray[np.float64] | \",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\" = \",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\"\\n\\n    \",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-title function_\",\"children\":\"apply_canny\"}],\"(\",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-params\",\"children\":\"self, img_array: npt.NDArray[np.uint8]\"}],\") -\u003e \",[\"$\",\"span\",\"span-18\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\":\\n        \",[\"$\",\"span\",\"span-19\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" cv2 \",[\"$\",\"span\",\"span-20\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" Canny\\n\\n        \",[\"$\",\"span\",\"span-21\",{\"className\":\"hljs-variable language_\",\"children\":\"self\"}],\".canny_array = Canny(img_array, \",[\"$\",\"span\",\"span-22\",{\"className\":\"hljs-number\",\"children\":\"100\"}],\", \",[\"$\",\"span\",\"span-23\",{\"className\":\"hljs-number\",\"children\":\"200\"}],\").astype(np.float64)\\n\\n    \",[\"$\",\"span\",\"span-24\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-25\",{\"className\":\"hljs-title function_\",\"children\":\"apply_sobel\"}],\"(\",[\"$\",\"span\",\"span-26\",{\"className\":\"hljs-params\",\"children\":\"self, dog_array: npt.NDArray[np.float64]\"}],\") -\u003e \",[\"$\",\"span\",\"span-27\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\":\\n        \",[\"$\",\"span\",\"span-28\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" modules.edge_detection.sobel \",[\"$\",\"span\",\"span-29\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" sobel_filter\\n\\n        \",[\"$\",\"span\",\"span-30\",{\"className\":\"hljs-variable language_\",\"children\":\"self\"}],\".angles, \",[\"$\",\"span\",\"span-31\",{\"className\":\"hljs-variable language_\",\"children\":\"self\"}],\".magnitudes = sobel_filter(dog_array)\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-25\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"and the sobel filter:\"}],\"\\n\",[\"$\",\"pre\",\"pre-6\",{\"className\":\"rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-py text-xs\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" numpy \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"as\"}],\" np\\n\",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" numpy.typing \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-keyword\",\"children\":\"as\"}],\" npt\\n\\n\",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" numba \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" njit\\n\",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" cv2 \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" Sobel, CV_64F\\n\\n\\n\",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-meta\",\"children\":[\"@njit(\",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-params\",\"children\":[\"fastmath=\",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-literal\",\"children\":\"True\"}],\", cache=\",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-literal\",\"children\":\"True\"}]]}],\")\"]}],\"\\n\",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-title function_\",\"children\":\"calculate_magnitudes_and_angles\"}],\"(\",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-params\",\"children\":\"\\n    grad_x: npt.NDArray[np.float64],\\n    grad_y: npt.NDArray[np.float64],\\n\"}],\") -\u003e \",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-built_in\",\"children\":\"tuple\"}],\"[npt.NDArray[np.float64], npt.NDArray[np.float64]]:\\n    magnitudes = np.sqrt(grad_x**\",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-number\",\"children\":\"2\"}],\" + grad_y**\",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-number\",\"children\":\"2\"}],\")\\n    max_value = np.\",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-built_in\",\"children\":\"max\"}],\"(magnitudes)\\n    \",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" max_value \u003e \",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-number\",\"children\":\"0\"}],\":\\n        magnitudes /= max_value\\n    angles = np.arctan2(grad_y, grad_x) * \",[\"$\",\"span\",\"span-18\",{\"className\":\"hljs-number\",\"children\":\"180\"}],\" / np.pi\\n    \",[\"$\",\"span\",\"span-19\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" angles, magnitudes\\n\\n\\n\",[\"$\",\"span\",\"span-20\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-21\",{\"className\":\"hljs-title function_\",\"children\":\"sobel_filter\"}],\"(\",[\"$\",\"span\",\"span-22\",{\"className\":\"hljs-params\",\"children\":\"\\n    dog_array: npt.NDArray[np.float64],\\n\"}],\") -\u003e \",[\"$\",\"span\",\"span-23\",{\"className\":\"hljs-built_in\",\"children\":\"tuple\"}],\"[npt.NDArray[np.float64], npt.NDArray[np.float64]]:\\n    grad_x = Sobel(dog_array, CV_64F, \",[\"$\",\"span\",\"span-24\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\", \",[\"$\",\"span\",\"span-25\",{\"className\":\"hljs-number\",\"children\":\"0\"}],\", ksize=\",[\"$\",\"span\",\"span-26\",{\"className\":\"hljs-number\",\"children\":\"3\"}],\")\\n    grad_y = Sobel(dog_array, CV_64F, \",[\"$\",\"span\",\"span-27\",{\"className\":\"hljs-number\",\"children\":\"0\"}],\", \",[\"$\",\"span\",\"span-28\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\", ksize=\",[\"$\",\"span\",\"span-29\",{\"className\":\"hljs-number\",\"children\":\"3\"}],\")\\n\\n    angles, magnitudes = calculate_magnitudes_and_angles(grad_x, grad_y)\\n\\n    \",[\"$\",\"span\",\"span-30\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" angles, magnitudes\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-26\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":[\"so in the \",[\"$\",\"code\",\"code-0\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"process_image\"}],\", add:\"]}],\"\\n\",[\"$\",\"pre\",\"pre-7\",{\"className\":\"rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-py text-xs\",\"children\":[\"    edge_detection_parameters: EdgeDetection = EdgeDetection()\\n    \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" edge_detection:\\n        edge_detection_parameters.apply_canny(image)\\n        edge_detection_parameters.apply_sobel(gray_array)\\n\"]}]}],\"\\n\",[\"$\",\"h2\",\"h2-5\",{\"className\":\"text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2\",\"children\":\"Color correction\"}],\"\\n\",[\"$\",\"p\",\"p-27\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":[\"Even if we apply the best possible ascii replacement for the pixels, the image will still contain some pixels from the background color, in this case, it's black; it makes that the ascii art image to looks darker. To improve this, we can apply some enhancements to the colors of the ascii image, for that I've implemented some post processing strategies: \",[\"$\",\"code\",\"code-0\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"brightness\"}],\", \",[\"$\",\"code\",\"code-1\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"contrast\"}],\", \",[\"$\",\"code\",\"code-2\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"exposure\"}],\" and \",[\"$\",\"code\",\"code-3\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"saturation\"}],\".\"]}],\"\\n\",[\"$\",\"pre\",\"pre-8\",{\"className\":\"rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-py text-xs\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" abc \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" ABC, abstractmethod\\n\",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" dataclasses \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" dataclass\\n\",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" enum \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" Enum\\n\\n\",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" numpy \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" uint8\\n\",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" numpy.typing \",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" NDArray\\n\\n\\n\",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-title class_\",\"children\":\"PostProcessingStrategyName\"}],\"(\",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-title class_ inherited__\",\"children\":\"Enum\"}],\"):\\n    BRIGHTNESS = \",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-string\",\"children\":\"\\\"brightness\\\"\"}],\"\\n    CONTRAST = \",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-string\",\"children\":\"\\\"contrast\\\"\"}],\"\\n    EXPOSURE = \",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-string\",\"children\":\"\\\"exposure\\\"\"}],\"\\n    SATURATION = \",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-string\",\"children\":\"\\\"saturation\\\"\"}],\"\\n\\n\\n\",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-meta\",\"children\":\"@dataclass\"}],\"\\n\",[\"$\",\"span\",\"span-18\",{\"className\":\"hljs-keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",\"span-19\",{\"className\":\"hljs-title class_\",\"children\":\"PostProcessingStrategy\"}],\"(\",[\"$\",\"span\",\"span-20\",{\"className\":\"hljs-title class_ inherited__\",\"children\":\"ABC\"}],\"):\\n    name: PostProcessingStrategyName\\n\\n\",[\"$\",\"span\",\"span-21\",{\"className\":\"hljs-meta\",\"children\":\"    @abstractmethod\"}],\"\\n    \",[\"$\",\"span\",\"span-22\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-23\",{\"className\":\"hljs-title function_\",\"children\":\"apply\"}],\"(\",[\"$\",\"span\",\"span-24\",{\"className\":\"hljs-params\",\"children\":[\"self, image: NDArray[uint8], value: \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-built_in\",\"children\":\"float\"}]]}],\") -\u003e NDArray[uint8]:\\n        \",[\"$\",\"span\",\"span-25\",{\"className\":\"hljs-string\",\"children\":\"\\\"\\\"\\\"Apply a post-processing effect to an image.\\n\\n        Args:\\n            image: The input image as a NumPy array (BGR format).\\n            value: The intensity of the effect.\\n\\n        Returns:\\n            The processed image as a NumPy array.\\n\\n        \\\"\\\"\\\"\"}],\"\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-28\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"then you can load them using a helper function:\"}],\"\\n\",[\"$\",\"pre\",\"pre-9\",{\"className\":\"rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-py text-xs\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" functools \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" cache\\n\",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" importlib \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" import_module\\n\",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" typing \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" cast\\n\\n\",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" numpy \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" uint8\\n\",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" numpy.typing \",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" NDArray\\n\\n\",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" . \",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" PostProcessingStrategy\\n\\n\\n\",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-title class_\",\"children\":\"PostProcessingLoader\"}],\":\\n\",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-meta\",\"children\":\"    @staticmethod\"}],\"\\n    \",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-title function_\",\"children\":\"_get_module_and_class\"}],\"(\",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-params\",\"children\":[\"strategy_name: \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-built_in\",\"children\":\"str\"}]]}],\") -\u003e \",[\"$\",\"span\",\"span-18\",{\"className\":\"hljs-built_in\",\"children\":\"tuple\"}],\"[\",[\"$\",\"span\",\"span-19\",{\"className\":\"hljs-built_in\",\"children\":\"str\"}],\", \",[\"$\",\"span\",\"span-20\",{\"className\":\"hljs-built_in\",\"children\":\"str\"}],\"]:\\n        module_name: \",[\"$\",\"span\",\"span-21\",{\"className\":\"hljs-built_in\",\"children\":\"str\"}],\" = \",[\"$\",\"span\",\"span-22\",{\"className\":\"hljs-string\",\"children\":[\"f\\\".\",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-subst\",\"children\":\"{strategy_name}\"}],\"\\\"\"]}],\"\\n        class_name: \",[\"$\",\"span\",\"span-23\",{\"className\":\"hljs-built_in\",\"children\":\"str\"}],\" = strategy_name.capitalize()\\n        \",[\"$\",\"span\",\"span-24\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" module_name, class_name\\n\\n\",[\"$\",\"span\",\"span-25\",{\"className\":\"hljs-meta\",\"children\":\"    @staticmethod\"}],\"\\n\",[\"$\",\"span\",\"span-26\",{\"className\":\"hljs-meta\",\"children\":\"    @cache\"}],\"\\n    \",[\"$\",\"span\",\"span-27\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-28\",{\"className\":\"hljs-title function_\",\"children\":\"get_strategy\"}],\"(\",[\"$\",\"span\",\"span-29\",{\"className\":\"hljs-params\",\"children\":[\"name: \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-built_in\",\"children\":\"str\"}]]}],\") -\u003e PostProcessingStrategy | \",[\"$\",\"span\",\"span-30\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\":\\n        \",[\"$\",\"span\",\"span-31\",{\"className\":\"hljs-keyword\",\"children\":\"try\"}],\":\\n            module_name, class_name = PostProcessingLoader._get_module_and_class(name)\\n            module = import_module(module_name, package=__package__)\\n            strategy_class = \",[\"$\",\"span\",\"span-32\",{\"className\":\"hljs-built_in\",\"children\":\"getattr\"}],\"(module, class_name)\\n            \",[\"$\",\"span\",\"span-33\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" cast(\",[\"$\",\"span\",\"span-34\",{\"className\":\"hljs-string\",\"children\":\"\\\"PostProcessingStrategy\\\"\"}],\", strategy_class())\\n        \",[\"$\",\"span\",\"span-35\",{\"className\":\"hljs-keyword\",\"children\":\"except\"}],\" (ImportError, AttributeError):\\n            \",[\"$\",\"span\",\"span-36\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",\"span-37\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\"\\n\\n\\n\",[\"$\",\"span\",\"span-38\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-39\",{\"className\":\"hljs-title function_\",\"children\":\"get_post_processing_strategy\"}],\"(\",[\"$\",\"span\",\"span-40\",{\"className\":\"hljs-params\",\"children\":[\"name: \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-built_in\",\"children\":\"str\"}]]}],\") -\u003e PostProcessingStrategy | \",[\"$\",\"span\",\"span-41\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\":\\n    \",[\"$\",\"span\",\"span-42\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" PostProcessingLoader.get_strategy(name)\\n\\n\\n\",[\"$\",\"span\",\"span-43\",{\"className\":\"hljs-keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",\"span-44\",{\"className\":\"hljs-title function_\",\"children\":\"apply_post_processing\"}],\"(\",[\"$\",\"span\",\"span-45\",{\"className\":\"hljs-params\",\"children\":\"image: NDArray[uint8]\"}],\") -\u003e NDArray[uint8]:\\n    post_processing_parameters: \",[\"$\",\"span\",\"span-46\",{\"className\":\"hljs-built_in\",\"children\":\"dict\"}],\"[\",[\"$\",\"span\",\"span-47\",{\"className\":\"hljs-built_in\",\"children\":\"str\"}],\", \",[\"$\",\"span\",\"span-48\",{\"className\":\"hljs-built_in\",\"children\":\"float\"}],\"] = {\\n        \",[\"$\",\"span\",\"span-49\",{\"className\":\"hljs-string\",\"children\":\"\\\"brightness\\\"\"}],\": \",[\"$\",\"span\",\"span-50\",{\"className\":\"hljs-number\",\"children\":\"6.0\"}],\",\\n        \",[\"$\",\"span\",\"span-51\",{\"className\":\"hljs-string\",\"children\":\"\\\"contrast\\\"\"}],\": \",[\"$\",\"span\",\"span-52\",{\"className\":\"hljs-number\",\"children\":\"1.28\"}],\",\\n        \",[\"$\",\"span\",\"span-53\",{\"className\":\"hljs-string\",\"children\":\"\\\"saturation\\\"\"}],\": \",[\"$\",\"span\",\"span-54\",{\"className\":\"hljs-number\",\"children\":\"1.22\"}],\",\\n        \",[\"$\",\"span\",\"span-55\",{\"className\":\"hljs-string\",\"children\":\"\\\"exposure\\\"\"}],\": \",[\"$\",\"span\",\"span-56\",{\"className\":\"hljs-number\",\"children\":\"1.18\"}],\",\\n    }\\n\\n    \",[\"$\",\"span\",\"span-57\",{\"className\":\"hljs-keyword\",\"children\":\"for\"}],\" filter_name, value \",[\"$\",\"span\",\"span-58\",{\"className\":\"hljs-keyword\",\"children\":\"in\"}],\" post_processing_parameters.items():\\n        filter_strategy: PostProcessingStrategy | \",[\"$\",\"span\",\"span-59\",{\"className\":\"hljs-literal\",\"children\":\"None\"}],\" = get_post_processing_strategy(\\n            filter_name,\\n        )\\n        \",[\"$\",\"span\",\"span-60\",{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" filter_strategy:\\n            image = filter_strategy.apply(image, value)\\n    \",[\"$\",\"span\",\"span-61\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" image\\n\"]}]}],\"\\n\",[\"$\",\"h2\",\"h2-6\",{\"className\":\"text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2\",\"children\":\"Further\"}],\"\\n\",[\"$\",\"p\",\"p-29\",{\"className\":\"text-base text-zinc-300 my-4 leading-relaxed\",\"children\":\"I've just explained what to do, and not exactly how to do, and that's because in the implementation is the joyness of this. Try to do the optimizations for yourself, be aware that despite python could be a good idea because of the libraries for image processing, it's really slow, it could work fast for images but you will suffer in videos.\"}]]}]}]]}]]}],\"$undefined\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/heneos-blog/_next/static/css/5eacd01f773eed7f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L5\",null,{\"children\":[\"$L6\",\"$L7\",null]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"Aqsf6yTn019BPd1IuR475\",{\"children\":[[\"$\",\"$L8\",null,{\"children\":\"$L9\"}],null]}],[\"$\",\"$La\",null,{\"children\":\"$Lb\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$c\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"9:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n6:null\n"])</script><script>self.__next_f.push([1,"7:null\nb:[[\"$\",\"title\",\"0\",{\"children\":\"Ascii Art | HeNeos blog\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Implement a non-naive ascii art\"}]]\n"])</script></body></html>