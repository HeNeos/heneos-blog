<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="https://projecteuler.net/resources/images/0199_circles_in_circles.gif?1678992055"/><link rel="preload" as="image" href="https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/PE-199/circles_1.png"/><link rel="preload" as="image" href="https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/PE-199/circles_2.png"/><link rel="preload" as="image" href="https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/PE-199/screenshot.png"/><link rel="preload" as="image" href="https://projecteuler.net/profile/HeNeos.png"/><link rel="stylesheet" href="/heneos-blog/_next/static/css/10c5481d6c776747.css" data-precedence="next"/><link rel="stylesheet" href="/heneos-blog/_next/static/css/894b41753079a4a0.css" data-precedence="next"/><link rel="stylesheet" href="/heneos-blog/_next/static/css/5eacd01f773eed7f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/heneos-blog/_next/static/chunks/webpack-f5e2af5b5e96ca99.js"/><script src="/heneos-blog/_next/static/chunks/4bd1b696-2bfa57da125389e3.js" async=""></script><script src="/heneos-blog/_next/static/chunks/587-b330864006e0cdca.js" async=""></script><script src="/heneos-blog/_next/static/chunks/main-app-c254e3910443191a.js" async=""></script><script src="/heneos-blog/_next/static/chunks/app/blog/%5Bslug%5D/page-4374ee6693381f28.js" async=""></script><title>Project Euler 199 | HeNeos blog</title><meta name="description" content="Solving Project Euler 199 | Iterative Circle Packing"/><script src="/heneos-blog/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="bg-zinc-950 text-zinc-100 min-h-screen"><header class="p-6 border-b border-zinc-800"><div class="max-w-6xl mx-auto"><div class="mb-10"><h1 class="text-4xl font-bold tracking-tighter mb-4 text-center">HeNeos blog</h1><p class="text-center text-zinc-500 mb-2">Josue H. @ JP Morgan Chase</p><p class="text-center text-zinc-600">HeNeos</p></div><div class="flex justify-center space-x-20 mb-4"><a target="_blank" class="text-zinc-500 hover:text-accent animated-underline" href="https://github.com/HeNeos">GitHub</a><a target="_blank" class="text-zinc-500 hover:text-accent animated-underline" href="https://www.linkedin.com/in/heneos">LinkedIn</a><a class="text-zinc-500 hover:text-accent animated-underline" href="mailto:he.neos@outlook.com">Email</a></div><div class="flex flex-col sm:flex-row justify-center gap-4 border-t border-zinc-800 pt-4"><a href="/heneos-blog"><div class="cursor-pointer hover:bg-gray-200 hover:text-zinc-900 transition-colors px-4 py-2 rounded-md flex items-center justify-between"><span>Home</span><span class="text-zinc-500 ml-6">ha</span></div></a><a href="/heneos-blog/blog"><div class="cursor-pointer hover:bg-gray-200 hover:text-zinc-900 transition-colors px-4 py-2 rounded-md flex items-center justify-between"><span>Blog</span><span class="text-zinc-500 ml-6">hb</span></div></a><a href="/heneos-blog/about"><div class="cursor-pointer hover:bg-gray-200 hover:text-zinc-900 transition-colors px-4 py-2 rounded-md flex items-center justify-between"><span>About</span><span class="text-zinc-500 ml-6">hc</span></div></a></div></div></header><main class="container mx-auto px-4 py-8 max-w-5xl"><div class="max-w-5xl mx-auto"><a class="text-zinc-500 hover:text-blue-400 mb-6 inline-block animated-underline" href="/heneos-blog/blog">← Back to all posts</a><article class="border border-zinc-800 rounded-lg p-4 bg-zinc-900/30"><header class="mb-8 border-b border-zinc-800 pb-6"><h1 class="text-3xl font-bold mb-4 gradient-text">Project Euler 199</h1><p class="text-zinc-500 mb-4 font-mono">August 20, 2023</p><div class="flex gap-2 flex-wrap"><span class="inline-block bg-zinc-800 text-zinc-300 px-2 py-1 text-xs rounded-sm">#<!-- -->project-euler</span><span class="inline-block bg-zinc-800 text-zinc-300 px-2 py-1 text-xs rounded-sm">#<!-- -->algorithms</span><span class="inline-block bg-zinc-800 text-zinc-300 px-2 py-1 text-xs rounded-sm">#<!-- -->geometry</span></div></header><div class="gap-4 mt-8"><div class="prose prose-invert prose-zinc max-w-none"><p class="text-sm text-zinc-300 my-4 leading-relaxed">Recently I was working on the <em>Circle packing</em> problem, which is a hard optimization problem. However, this Project Euler problem is not so much related to optimization problems, this is more of a <strong>geometric</strong> problem. I also had some fun doing this problem, plotting and generating an animation of the circles.</p>
<h2 class="text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2">Statement</h2>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">Three circles of equal radius are placed inside a larger circle such that each pair of circles is tangent to one another and the inner circles do not overlap. There are four uncovered &quot;gaps&quot; which are to be filled iteratively with more tangent circles.</p>
<div class="image-container my-8"><img src="https://projecteuler.net/resources/images/0199_circles_in_circles.gif?1678992055" alt="PE-199" width="60%" height="auto" class="object-contain mx-auto"/></div>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">At each iteration, a maximally sized circle is placed in each gap, which creates more gaps for the next iteration. After 3 iterations (pictured), there are <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>108</mn></mrow><annotation encoding="application/x-tex">108</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">108</span></span></span></span> gaps and the fraction of the area which is not covered by circles is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.06790342</mn></mrow><annotation encoding="application/x-tex">0.06790342</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.06790342</span></span></span></span>, rounded to eight decimal places.</p>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">What fraction of the area is not covered by circles after <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">10</span></span></span></span> iterations?
Give your answer rounded to eight decimal places using the format <em>x.xxxxxxxx</em>.</p>
<h2 class="text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2">Solution</h2>
<h3 class="text-lg font-bold mt-6 mb-3 text-zinc-100">Calculating radius</h3>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">Let&#x27;s see what happens with the first iteration:</p>
<div class="image-container my-8"><img src="https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/PE-199/circles_1.png" alt="circles_1" width="60%" height="auto" class="object-contain mx-auto"/></div>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">It&#x27;s easy to see that the results are <em>symmetric</em>, in a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>120</mn><mo lspace="0em" rspace="0em">∘</mo></msup></mrow><annotation encoding="application/x-tex">120^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6741em"></span><span class="mord">12</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6741em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∘</span></span></span></span></span></span></span></span></span></span></span></span> fashion, and also includes a central circle that is also tangent to the three circles of iteration 0.</p>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">Let&#x27;s clarify this with a new iteration:</p>
<div class="image-container my-8"><img src="https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/PE-199/circles_2.png" alt="circles_2" width="60%" height="auto" class="object-contain mx-auto"/></div>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">Let&#x27;s think of this as an iterative approach. If all the circles of the previous iteration are already determined, how can the circles of the new iteration be drawn?</p>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">Note that, a circle is always tangent to three other circles that were drawn in a previous iteration. Suppose, those circles are <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span></span> and the circle that is tangent to them is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span></span></span>, the circles in the next iteration are tangent to:</p>
<ol class="text-xs list-decimal pl-6 my-4 text-zinc-300 space-y-2">
<li class="text-zinc-300"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span></span></span></li>
<li class="text-zinc-300"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span></span></span></li>
<li class="text-zinc-300"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span></span></span></li>
</ol>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">It means that, if you know what is the radius and center of a circle tangent to three other circles, you know how to place the circles for each iteration:</p>
<pre class="rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800"><code class="hljs language-c++ text-xs"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solve</span><span class="hljs-params">(vector &lt;vector &lt;dd&gt; &gt; &amp;radius)</span></span>{
    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> level=<span class="hljs-number">1</span>; level&lt;=<span class="hljs-number">10</span>; level++){
        vector &lt;vector &lt;dd&gt; &gt; new_radius;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> r_list: radius){
            dd r_A = r_list[<span class="hljs-number">0</span>];
            dd r_B = r_list[<span class="hljs-number">1</span>];
            dd r_C = r_list[<span class="hljs-number">2</span>];
            dd r_H = <span class="hljs-built_in">gen_radius</span>(r_A, r_B, r_C);
            new_radius.<span class="hljs-built_in">push_back</span>({r_A, r_B, r_H});
            new_radius.<span class="hljs-built_in">push_back</span>({r_A, r_C, r_H});
            new_radius.<span class="hljs-built_in">push_back</span>({r_B, r_C, r_H});
        }
        radius = new_radius;
    }
}
</code></pre>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">In fact, it&#x27;s not needed to know the position of the circle, as you already know the circles are tangent. So, to save memory you can just store the radius of the circles in each iteration. Be cautelous, because the amount of circles increases expontenially in each iteration.</p>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">Now, let&#x27;s think how calculate the new radius knowing the radius of three circles to which it is tangent.</p>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">This problem is an special case of the called <a href="https://en.wikipedia.org/wiki/Problem_of_Apollonius" class="text-blue-400 hover:underline" target="_blank" rel="noopener noreferrer"><em>Problem of Apollonius</em></a>, more specifically this could be solved using the <a href="https://en.wikipedia.org/wiki/Descartes%27_theorem" class="text-blue-400 hover:underline" target="_blank" rel="noopener noreferrer"><em>Descartes&#x27; theorem</em></a>.</p>
<pre class="rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800"><code class="hljs language-cpp text-xs"><span class="hljs-function">dd <span class="hljs-title">gen_radius</span><span class="hljs-params">(dd r_A, dd r_B, dd r_C)</span></span>{
    dd k = <span class="hljs-number">1</span>/r_A + <span class="hljs-number">1</span>/r_B + <span class="hljs-number">1</span>/r_C + <span class="hljs-number">2</span>*<span class="hljs-built_in">sqrt</span>(<span class="hljs-number">1</span>/(r_A*r_B) + <span class="hljs-number">1</span>/(r_B*r_C) + <span class="hljs-number">1</span>/(r_A*r_C));
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>/k;
}
</code></pre>
<h3 class="text-lg font-bold mt-6 mb-3 text-zinc-100">Plotting circles</h3>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">The problem is already solved, since it only needs the radius to compute the answer. However, if you want to see a nice animation about how the circles are being generated, you also need to calculate the coordinates.</p>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">The approach is really similar, just instead of storing the radius, store the <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">circle</code>.</p>
<pre class="rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800"><code class="hljs language-c++ text-xs"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solve</span><span class="hljs-params">(vector &lt;vector &lt;_circle&gt; &gt; &amp;circles)</span></span>{
  <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> level=<span class="hljs-number">2</span>; level&lt;=<span class="hljs-number">6</span>; level++){
    <span class="hljs-comment">// cout &lt;&lt; &quot;#############################\n&quot;;</span>
    <span class="hljs-comment">// cout &lt;&lt; &quot;LEVEL &quot; &lt;&lt; level &lt;&lt; &#x27;\n&#x27;;</span>
    vector &lt;vector &lt;_circle&gt; &gt; new_circles;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> circles_list: circles){
      _circle new_circle = <span class="hljs-built_in">gen_circle</span>(circles_list);
      cout &lt;&lt; <span class="hljs-string">&quot;Circle[{&quot;</span> &lt;&lt; new_circle.second.first &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> \
        &lt;&lt; new_circle.second.second &lt;&lt; <span class="hljs-string">&quot;}, &quot;</span> &lt;&lt; new_circle.first &lt;&lt; <span class="hljs-string">&quot;],\n&quot;</span>;
      new_circles.<span class="hljs-built_in">push_back</span>({circles_list[<span class="hljs-number">0</span>], circles_list[<span class="hljs-number">1</span>], new_circle});
      new_circles.<span class="hljs-built_in">push_back</span>({circles_list[<span class="hljs-number">0</span>], circles_list[<span class="hljs-number">2</span>], new_circle});
      new_circles.<span class="hljs-built_in">push_back</span>({circles_list[<span class="hljs-number">1</span>], circles_list[<span class="hljs-number">2</span>], new_circle});
    }
    circles = new_circles;
  }
}
</code></pre>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">and to calculate the coordinates:</p>
<pre class="rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800"><code class="hljs language-cpp text-xs"><span class="hljs-function">_point <span class="hljs-title">gen_coordinates</span><span class="hljs-params">(_circle c0, _circle c1, _circle c2, dd r)</span></span>{
    dd k0 = <span class="hljs-number">1</span>/c<span class="hljs-number">0.f</span>irst;
    dd k1 = <span class="hljs-number">1</span>/c<span class="hljs-number">1.f</span>irst;
    dd k2 = <span class="hljs-number">1</span>/c<span class="hljs-number">2.f</span>irst;
    dd x0 = c<span class="hljs-number">0.</span>second.first; dd y0 = c<span class="hljs-number">0.</span>second.second;
    dd x1 = c<span class="hljs-number">1.</span>second.first; dd y1 = c<span class="hljs-number">1.</span>second.second;
    dd x2 = c<span class="hljs-number">2.</span>second.first; dd y2 = c<span class="hljs-number">2.</span>second.second;
    
    <span class="hljs-comment">// (x0+iy0)*(x1+iy1) = x0x1 - y0y1 + i(x1y0 + x0y1)</span>
    dd Sx = k0*k1*(x0*x1-y0*y1) + k1*k2*(x1*x2-y1*y2) + k0*k2*(x0*x2-y0*y2);
    dd Sy = k0*k1*(y0*x1+y1*x0) + k1*k2*(y1*x2+y2*x1) + k0*k2*(y0*x2+y2*x0);

    dd Cx = <span class="hljs-built_in">sqrt</span>((<span class="hljs-built_in">sqrt</span>(Sx*Sx+Sy*Sy)+Sx)/<span class="hljs-number">2</span>);
    dd Cy = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span>(Sy != <span class="hljs-number">0</span>) Cy = <span class="hljs-built_in">abs</span>(Sy)/Sy*<span class="hljs-built_in">sqrt</span>((<span class="hljs-built_in">sqrt</span>(Sx*Sx+Sy*Sy)-Sx)/<span class="hljs-number">2</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(Sx &lt; <span class="hljs-number">0</span>) Cy = <span class="hljs-built_in">sqrt</span>(-Sx);

    dd x_1 = (k0*x0 + k1*x1 + k2*x2 + <span class="hljs-number">2</span>*Cx)*r;
    dd y_1 = (k0*y0 + k1*y1 + k2*y2 + <span class="hljs-number">2</span>*Cy)*r;
    dd x_2 = (k0*x0 + k1*x1 + k2*x2 - <span class="hljs-number">2</span>*Cx)*r;
    dd y_2 = (k0*y0 + k1*y1 + k2*y2 - <span class="hljs-number">2</span>*Cy)*r;

    _circle c_1 = <span class="hljs-built_in">make_pair</span>(r, <span class="hljs-built_in">make_pair</span>(x_1, y_1));
    _circle c_2 = <span class="hljs-built_in">make_pair</span>(r, <span class="hljs-built_in">make_pair</span>(x_2, y_2));

    dd error1 = (<span class="hljs-built_in">check_tangency</span>(c_1, c0) + <span class="hljs-built_in">check_tangency</span>(c_1, c1) + <span class="hljs-built_in">check_tangency</span>(c_1, c2));
    dd error2 = (<span class="hljs-built_in">check_tangency</span>(c_2, c0) + <span class="hljs-built_in">check_tangency</span>(c_2, c1) + <span class="hljs-built_in">check_tangency</span>(c_2, c2));
    
    <span class="hljs-keyword">if</span>(error1 &lt; error2) <span class="hljs-keyword">return</span> <span class="hljs-built_in">make_pair</span>(x_1, y_1);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-built_in">make_pair</span>(x_2, y_2);
}
</code></pre>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">To avoid precision errors, you need to check the tangency, but it&#x27;s not enough so you need to check the error in the two possible solutions.</p>
<h3 class="text-lg font-bold mt-6 mb-3 text-zinc-100">P5.js</h3>
<p class="text-sm text-zinc-300 my-4 leading-relaxed"><code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">C++</code> is not a good language to make plots or animations, so I searched for other tools for this purpouse. I&#x27;ll use <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">P5.js</code> and I&#x27;ll port my <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">C++</code> code to <code class="bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs">JS</code>.</p>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">This is a plot in high resolution with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">10</span></span></span></span> iterations.</p>
<!-- -->
<div class="image-container my-8"><img src="https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/PE-199/screenshot.png" alt="screenshot" width="60%" height="auto" class="object-contain mx-auto"/></div>
<p class="text-sm text-zinc-300 my-4 leading-relaxed">You can also make an animation using this tool.</p></div></div></article></div></main><footer class="border-t border-zinc-800 py-6 mt-12"><div class="container mx-auto px-4 relative h-full"><div class="grid grid-cols-1 md:grid-cols-2 gap-8"><div><h3 class="text-lg font-semibold text-white mb-4">Connect</h3><div class="flex space-x-4"><a href="https://github.com/HeNeos" target="_blank" rel="noopener noreferrer" class="text-slate-400 hover:text-white transition-colors">GitHub</a><a href="https://x.com/_HeNeos" target="_blank" rel="noopener noreferrer" class="text-slate-400 hover:text-white transition-colors">X</a><a href="https://codeforces.com/profile/HeNeos" target="_blank" rel="noopener noreferrer" class="text-slate-400 hover:text-white transition-colors">Codeforces</a><a href="https://codeforces.com/profile/Ptolemy_314" target="_blank" rel="noopener noreferrer" class="text-slate-400 hover:text-white transition-colors">Codeforces old</a></div></div><div><h4 class="text-lg font-semibold text-white mb-4">Project Euler</h4><a href="https://projecteuler.net/profile/HeNeos.png" target="_blank" rel="noopener noreferrer"><img src="https://projecteuler.net/profile/HeNeos.png" alt="Project Euler Profile" class=" h-auto max-h-10 rounded-sm object-contain"/></a></div></div></div></footer><script src="/heneos-blog/_next/static/chunks/webpack-f5e2af5b5e96ca99.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[8173,[\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-4374ee6693381f28.js\"],\"\"]\n3:I[5244,[],\"\"]\n4:I[3866,[],\"\"]\n5:I[6213,[],\"OutletBoundary\"]\n8:I[6213,[],\"ViewportBoundary\"]\na:I[6213,[],\"MetadataBoundary\"]\nc:I[4835,[],\"\"]\n:HL[\"/heneos-blog/_next/static/css/10c5481d6c776747.css\",\"style\"]\n:HL[\"/heneos-blog/_next/static/css/894b41753079a4a0.css\",\"style\"]\n:HL[\"/heneos-blog/_next/static/css/5eacd01f773eed7f.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"X156B5Izg3NHbBN6q777i\",\"p\":\"/heneos-blog\",\"c\":[\"\",\"blog\",\"2023-08-20-pe-199\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"2023-08-20-pe-199\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/heneos-blog/_next/static/css/10c5481d6c776747.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/heneos-blog/_next/static/css/894b41753079a4a0.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"bg-zinc-950 text-zinc-100 min-h-screen\",\"children\":[[\"$\",\"header\",null,{\"className\":\"p-6 border-b border-zinc-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-6xl mx-auto\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-10\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-4xl font-bold tracking-tighter mb-4 text-center\",\"children\":\"HeNeos blog\"}],[\"$\",\"p\",null,{\"className\":\"text-center text-zinc-500 mb-2\",\"children\":\"Josue H. @ JP Morgan Chase\"}],[\"$\",\"p\",null,{\"className\":\"text-center text-zinc-600\",\"children\":\"HeNeos\"}]]}],[\"$\",\"div\",null,{\"className\":\"flex justify-center space-x-20 mb-4\",\"children\":[[\"$\",\"$L2\",null,{\"href\":\"https://github.com/HeNeos\",\"target\":\"_blank\",\"className\":\"text-zinc-500 hover:text-accent animated-underline\",\"children\":\"GitHub\"}],[\"$\",\"$L2\",null,{\"href\":\"https://www.linkedin.com/in/heneos\",\"target\":\"_blank\",\"className\":\"text-zinc-500 hover:text-accent animated-underline\",\"children\":\"LinkedIn\"}],[\"$\",\"$L2\",null,{\"href\":\"mailto:he.neos@outlook.com\",\"className\":\"text-zinc-500 hover:text-accent animated-underline\",\"children\":\"Email\"}]]}],[\"$\",\"div\",null,{\"className\":\"flex flex-col sm:flex-row justify-center gap-4 border-t border-zinc-800 pt-4\",\"children\":[[\"$\",\"$L2\",null,{\"href\":\"/\",\"children\":[\"$\",\"div\",null,{\"className\":\"cursor-pointer hover:bg-gray-200 hover:text-zinc-900 transition-colors px-4 py-2 rounded-md flex items-center justify-between\",\"children\":[[\"$\",\"span\",null,{\"children\":\"Home\"}],[\"$\",\"span\",null,{\"className\":\"text-zinc-500 ml-6\",\"children\":\"ha\"}]]}]}],[\"$\",\"$L2\",null,{\"href\":\"/blog\",\"children\":[\"$\",\"div\",null,{\"className\":\"cursor-pointer hover:bg-gray-200 hover:text-zinc-900 transition-colors px-4 py-2 rounded-md flex items-center justify-between\",\"children\":[[\"$\",\"span\",null,{\"children\":\"Blog\"}],[\"$\",\"span\",null,{\"className\":\"text-zinc-500 ml-6\",\"children\":\"hb\"}]]}]}],[\"$\",\"$L2\",null,{\"href\":\"/about\",\"children\":[\"$\",\"div\",null,{\"className\":\"cursor-pointer hover:bg-gray-200 hover:text-zinc-900 transition-colors px-4 py-2 rounded-md flex items-center justify-between\",\"children\":[[\"$\",\"span\",null,{\"children\":\"About\"}],[\"$\",\"span\",null,{\"className\":\"text-zinc-500 ml-6\",\"children\":\"hc\"}]]}]}]]}]]}]}],[\"$\",\"main\",null,{\"className\":\"container mx-auto px-4 py-8 max-w-5xl\",\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"$undefined\",[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"border-t border-zinc-800 py-6 mt-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"container mx-auto px-4 relative h-full\",\"children\":[\"$\",\"div\",null,{\"className\":\"grid grid-cols-1 md:grid-cols-2 gap-8\",\"children\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"h3\",null,{\"className\":\"text-lg font-semibold text-white mb-4\",\"children\":\"Connect\"}],[\"$\",\"div\",null,{\"className\":\"flex space-x-4\",\"children\":[[\"$\",\"a\",null,{\"href\":\"https://github.com/HeNeos\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-slate-400 hover:text-white transition-colors\",\"children\":\"GitHub\"}],[\"$\",\"a\",null,{\"href\":\"https://x.com/_HeNeos\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-slate-400 hover:text-white transition-colors\",\"children\":\"X\"}],[\"$\",\"a\",null,{\"href\":\"https://codeforces.com/profile/HeNeos\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-slate-400 hover:text-white transition-colors\",\"children\":\"Codeforces\"}],[\"$\",\"a\",null,{\"href\":\"https://codeforces.com/profile/Ptolemy_314\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-slate-400 hover:text-white transition-colors\",\"children\":\"Codeforces old\"}]]}]]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"h4\",null,{\"className\":\"text-lg font-semibold text-white mb-4\",\"children\":\"Project Euler\"}],[\"$\",\"a\",null,{\"href\":\"https://projecteuler.net/profile/HeNeos.png\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"children\":[\"$\",\"img\",null,{\"src\":\"https://projecteuler.net/profile/HeNeos.png\",\"alt\":\"Project Euler Profile\",\"className\":\" h-auto max-h-10 rounded-sm object-contain\"}]}]]}]]}]}]}]]}]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"2023-08-20-pe-199\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[[\"$\",\"div\",null,{\"className\":\"max-w-5xl mx-auto\",\"children\":[[\"$\",\"$L2\",null,{\"href\":\"/blog\",\"className\":\"text-zinc-500 hover:text-blue-400 mb-6 inline-block animated-underline\",\"children\":\"← Back to all posts\"}],[\"$\",\"article\",null,{\"className\":\"border border-zinc-800 rounded-lg p-4 bg-zinc-900/30\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-8 border-b border-zinc-800 pb-6\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-3xl font-bold mb-4 gradient-text\",\"children\":\"Project Euler 199\"}],[\"$\",\"p\",null,{\"className\":\"text-zinc-500 mb-4 font-mono\",\"children\":\"August 20, 2023\"}],[\"$\",\"div\",null,{\"className\":\"flex gap-2 flex-wrap\",\"children\":[[\"$\",\"span\",\"project-euler\",{\"className\":\"inline-block bg-zinc-800 text-zinc-300 px-2 py-1 text-xs rounded-sm\",\"children\":[\"#\",\"project-euler\"]}],[\"$\",\"span\",\"algorithms\",{\"className\":\"inline-block bg-zinc-800 text-zinc-300 px-2 py-1 text-xs rounded-sm\",\"children\":[\"#\",\"algorithms\"]}],[\"$\",\"span\",\"geometry\",{\"className\":\"inline-block bg-zinc-800 text-zinc-300 px-2 py-1 text-xs rounded-sm\",\"children\":[\"#\",\"geometry\"]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"gap-4 mt-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"prose prose-invert prose-zinc max-w-none\",\"children\":[[\"$\",\"p\",\"p-0\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":[\"Recently I was working on the \",[\"$\",\"em\",\"em-0\",{\"children\":\"Circle packing\"}],\" problem, which is a hard optimization problem. However, this Project Euler problem is not so much related to optimization problems, this is more of a \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"geometric\"}],\" problem. I also had some fun doing this problem, plotting and generating an animation of the circles.\"]}],\"\\n\",[\"$\",\"h2\",\"h2-0\",{\"className\":\"text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2\",\"children\":\"Statement\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":\"Three circles of equal radius are placed inside a larger circle such that each pair of circles is tangent to one another and the inner circles do not overlap. There are four uncovered \\\"gaps\\\" which are to be filled iteratively with more tangent circles.\"}],\"\\n\",[\"$\",\"div\",\"img-0\",{\"className\":\"image-container my-8\",\"children\":[\"$\",\"img\",null,{\"src\":\"https://projecteuler.net/resources/images/0199_circles_in_circles.gif?1678992055\",\"alt\":\"PE-199\",\"width\":\"60%\",\"height\":\"auto\",\"className\":\"object-contain mx-auto\"}]}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":[\"At each iteration, a maximally sized circle is placed in each gap, which creates more gaps for the next iteration. After 3 iterations (pictured), there are \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mn\",\"mn-0\",{\"children\":\"108\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"108\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"108\"}]]}]}]]}],\" gaps and the fraction of the area which is not covered by circles is \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mn\",\"mn-0\",{\"children\":\"0.06790342\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"0.06790342\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"0.06790342\"}]]}]}]]}],\", rounded to eight decimal places.\"]}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":[\"What fraction of the area is not covered by circles after \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"10\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"10\"}]]}]}]]}],\" iterations?\\nGive your answer rounded to eight decimal places using the format \",[\"$\",\"em\",\"em-0\",{\"children\":\"x.xxxxxxxx\"}],\".\"]}],\"\\n\",[\"$\",\"h2\",\"h2-1\",{\"className\":\"text-xl font-bold mt-8 mb-4 text-zinc-100 border-b border-zinc-800 pb-2\",\"children\":\"Solution\"}],\"\\n\",[\"$\",\"h3\",\"h3-0\",{\"className\":\"text-lg font-bold mt-6 mb-3 text-zinc-100\",\"children\":\"Calculating radius\"}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":\"Let's see what happens with the first iteration:\"}],\"\\n\",[\"$\",\"div\",\"img-1\",{\"className\":\"image-container my-8\",\"children\":[\"$\",\"img\",null,{\"src\":\"https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/PE-199/circles_1.png\",\"alt\":\"circles_1\",\"width\":\"60%\",\"height\":\"auto\",\"className\":\"object-contain mx-auto\"}]}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":[\"It's easy to see that the results are \",[\"$\",\"em\",\"em-0\",{\"children\":\"symmetric\"}],\", in a \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"120\"}],[\"$\",\"mo\",\"mo-0\",{\"lspace\":\"0em\",\"rspace\":\"0em\",\"children\":\"∘\"}]]}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"120^{\\\\circ}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6741em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"12\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.6741em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-3.063em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":\"∘\"}]}]}]]}]}]}]}]}]]}]]}]}]]}],\" fashion, and also includes a central circle that is also tangent to the three circles of iteration 0.\"]}],\"\\n\",[\"$\",\"p\",\"p-6\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":\"Let's clarify this with a new iteration:\"}],\"\\n\",[\"$\",\"div\",\"img-2\",{\"className\":\"image-container my-8\",\"children\":[\"$\",\"img\",null,{\"src\":\"https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/PE-199/circles_2.png\",\"alt\":\"circles_2\",\"width\":\"60%\",\"height\":\"auto\",\"className\":\"object-contain mx-auto\"}]}],\"\\n\",[\"$\",\"p\",\"p-7\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":\"Let's think of this as an iterative approach. If all the circles of the previous iteration are already determined, how can the circles of the new iteration be drawn?\"}],\"\\n\",[\"$\",\"p\",\"p-8\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":[\"Note that, a circle is always tangent to three other circles that were drawn in a previous iteration. Suppose, those circles are \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"A\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"A\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"children\":\"A\"}]]}]}]]}],\", \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"B\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"B\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.05017em\"},\"children\":\"B\"}]]}]}]]}],\", \",[\"$\",\"span\",\"span-2\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"C\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"C\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.07153em\"},\"children\":\"C\"}]]}]}]]}],\" and the circle that is tangent to them is \",[\"$\",\"span\",\"span-3\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"H\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"H\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.08125em\"},\"children\":\"H\"}]]}]}]]}],\", the circles in the next iteration are tangent to:\"]}],\"\\n\",[\"$\",\"ol\",\"ol-0\",{\"className\":\"text-xs list-decimal pl-6 my-4 text-zinc-300 space-y-2\",\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"className\":\"text-zinc-300\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"A\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"A\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"children\":\"A\"}]]}]}]]}],\", \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"C\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"C\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.07153em\"},\"children\":\"C\"}]]}]}]]}],\", \",[\"$\",\"span\",\"span-2\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"H\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"H\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.08125em\"},\"children\":\"H\"}]]}]}]]}]]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"className\":\"text-zinc-300\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"B\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"B\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.05017em\"},\"children\":\"B\"}]]}]}]]}],\", \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"C\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"C\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.07153em\"},\"children\":\"C\"}]]}]}]]}],\", \",[\"$\",\"span\",\"span-2\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"H\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"H\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.08125em\"},\"children\":\"H\"}]]}]}]]}]]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"className\":\"text-zinc-300\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"A\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"A\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"children\":\"A\"}]]}]}]]}],\", \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"B\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"B\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.05017em\"},\"children\":\"B\"}]]}]}]]}],\", \",[\"$\",\"span\",\"span-2\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"H\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"H\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.08125em\"},\"children\":\"H\"}]]}]}]]}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-9\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":\"It means that, if you know what is the radius and center of a circle tangent to three other circles, you know how to place the circles for each iteration:\"}],\"\\n\",[\"$\",\"pre\",\"pre-0\",{\"className\":\"rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-c++ text-xs\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-function\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-type\",\"children\":\"void\"}],\" \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-title\",\"children\":\"solve\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-params\",\"children\":\"(vector \u003cvector \u003cdd\u003e \u003e \u0026radius)\"}]]}],\"{\\n    \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"for\"}],\"(\",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-type\",\"children\":\"int\"}],\" level=\",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"; level\u003c=\",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-number\",\"children\":\"10\"}],\"; level++){\\n        vector \u003cvector \u003cdd\u003e \u003e new_radius;\\n        \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-keyword\",\"children\":\"for\"}],\"(\",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-keyword\",\"children\":\"auto\"}],\" r_list: radius){\\n            dd r_A = r_list[\",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-number\",\"children\":\"0\"}],\"];\\n            dd r_B = r_list[\",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"];\\n            dd r_C = r_list[\",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-number\",\"children\":\"2\"}],\"];\\n            dd r_H = \",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-built_in\",\"children\":\"gen_radius\"}],\"(r_A, r_B, r_C);\\n            new_radius.\",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-built_in\",\"children\":\"push_back\"}],\"({r_A, r_B, r_H});\\n            new_radius.\",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-built_in\",\"children\":\"push_back\"}],\"({r_A, r_C, r_H});\\n            new_radius.\",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-built_in\",\"children\":\"push_back\"}],\"({r_B, r_C, r_H});\\n        }\\n        radius = new_radius;\\n    }\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-10\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":\"In fact, it's not needed to know the position of the circle, as you already know the circles are tangent. So, to save memory you can just store the radius of the circles in each iteration. Be cautelous, because the amount of circles increases expontenially in each iteration.\"}],\"\\n\",[\"$\",\"p\",\"p-11\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":\"Now, let's think how calculate the new radius knowing the radius of three circles to which it is tangent.\"}],\"\\n\",[\"$\",\"p\",\"p-12\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":[\"This problem is an special case of the called \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://en.wikipedia.org/wiki/Problem_of_Apollonius\",\"className\":\"text-blue-400 hover:underline\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"children\":[\"$\",\"em\",\"em-0\",{\"children\":\"Problem of Apollonius\"}]}],\", more specifically this could be solved using the \",[\"$\",\"a\",\"a-1\",{\"href\":\"https://en.wikipedia.org/wiki/Descartes%27_theorem\",\"className\":\"text-blue-400 hover:underline\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"children\":[\"$\",\"em\",\"em-0\",{\"children\":\"Descartes' theorem\"}]}],\".\"]}],\"\\n\",[\"$\",\"pre\",\"pre-1\",{\"className\":\"rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-cpp text-xs\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-function\",\"children\":[\"dd \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-title\",\"children\":\"gen_radius\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-params\",\"children\":\"(dd r_A, dd r_B, dd r_C)\"}]]}],\"{\\n    dd k = \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"/r_A + \",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"/r_B + \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"/r_C + \",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-number\",\"children\":\"2\"}],\"*\",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-built_in\",\"children\":\"sqrt\"}],\"(\",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"/(r_A*r_B) + \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"/(r_B*r_C) + \",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"/(r_A*r_C));\\n    \",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"/k;\\n}\\n\"]}]}],\"\\n\",[\"$\",\"h3\",\"h3-1\",{\"className\":\"text-lg font-bold mt-6 mb-3 text-zinc-100\",\"children\":\"Plotting circles\"}],\"\\n\",[\"$\",\"p\",\"p-13\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":\"The problem is already solved, since it only needs the radius to compute the answer. However, if you want to see a nice animation about how the circles are being generated, you also need to calculate the coordinates.\"}],\"\\n\",[\"$\",\"p\",\"p-14\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":[\"The approach is really similar, just instead of storing the radius, store the \",[\"$\",\"code\",\"code-0\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"circle\"}],\".\"]}],\"\\n\",[\"$\",\"pre\",\"pre-2\",{\"className\":\"rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-c++ text-xs\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-function\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-type\",\"children\":\"void\"}],\" \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-title\",\"children\":\"solve\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-params\",\"children\":\"(vector \u003cvector \u003c_circle\u003e \u003e \u0026circles)\"}]]}],\"{\\n  \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"for\"}],\"(\",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-type\",\"children\":\"int\"}],\" level=\",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-number\",\"children\":\"2\"}],\"; level\u003c=\",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-number\",\"children\":\"6\"}],\"; level++){\\n    \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-comment\",\"children\":\"// cout \u003c\u003c \\\"#############################\\\\n\\\";\"}],\"\\n    \",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-comment\",\"children\":\"// cout \u003c\u003c \\\"LEVEL \\\" \u003c\u003c level \u003c\u003c '\\\\n';\"}],\"\\n    vector \u003cvector \u003c_circle\u003e \u003e new_circles;\\n    \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-keyword\",\"children\":\"for\"}],\"(\",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-keyword\",\"children\":\"auto\"}],\" circles_list: circles){\\n      _circle new_circle = \",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-built_in\",\"children\":\"gen_circle\"}],\"(circles_list);\\n      cout \u003c\u003c \",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-string\",\"children\":\"\\\"Circle[{\\\"\"}],\" \u003c\u003c new_circle.second.first \u003c\u003c \",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-string\",\"children\":\"\\\", \\\"\"}],\" \\\\\\n        \u003c\u003c new_circle.second.second \u003c\u003c \",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-string\",\"children\":\"\\\"}, \\\"\"}],\" \u003c\u003c new_circle.first \u003c\u003c \",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-string\",\"children\":\"\\\"],\\\\n\\\"\"}],\";\\n      new_circles.\",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-built_in\",\"children\":\"push_back\"}],\"({circles_list[\",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-number\",\"children\":\"0\"}],\"], circles_list[\",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"], new_circle});\\n      new_circles.\",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-built_in\",\"children\":\"push_back\"}],\"({circles_list[\",[\"$\",\"span\",\"span-18\",{\"className\":\"hljs-number\",\"children\":\"0\"}],\"], circles_list[\",[\"$\",\"span\",\"span-19\",{\"className\":\"hljs-number\",\"children\":\"2\"}],\"], new_circle});\\n      new_circles.\",[\"$\",\"span\",\"span-20\",{\"className\":\"hljs-built_in\",\"children\":\"push_back\"}],\"({circles_list[\",[\"$\",\"span\",\"span-21\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"], circles_list[\",[\"$\",\"span\",\"span-22\",{\"className\":\"hljs-number\",\"children\":\"2\"}],\"], new_circle});\\n    }\\n    circles = new_circles;\\n  }\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-15\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":\"and to calculate the coordinates:\"}],\"\\n\",[\"$\",\"pre\",\"pre-3\",{\"className\":\"rounded-sm p-4 overflow-auto bg-zinc-900 text-zinc-100 my-4 border border-zinc-800\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-cpp text-xs\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-function\",\"children\":[\"_point \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-title\",\"children\":\"gen_coordinates\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-params\",\"children\":\"(_circle c0, _circle c1, _circle c2, dd r)\"}]]}],\"{\\n    dd k0 = \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"/c\",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-number\",\"children\":\"0.f\"}],\"irst;\\n    dd k1 = \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"/c\",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-number\",\"children\":\"1.f\"}],\"irst;\\n    dd k2 = \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-number\",\"children\":\"1\"}],\"/c\",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-number\",\"children\":\"2.f\"}],\"irst;\\n    dd x0 = c\",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-number\",\"children\":\"0.\"}],\"second.first; dd y0 = c\",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-number\",\"children\":\"0.\"}],\"second.second;\\n    dd x1 = c\",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-number\",\"children\":\"1.\"}],\"second.first; dd y1 = c\",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-number\",\"children\":\"1.\"}],\"second.second;\\n    dd x2 = c\",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-number\",\"children\":\"2.\"}],\"second.first; dd y2 = c\",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-number\",\"children\":\"2.\"}],\"second.second;\\n    \\n    \",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-comment\",\"children\":\"// (x0+iy0)*(x1+iy1) = x0x1 - y0y1 + i(x1y0 + x0y1)\"}],\"\\n    dd Sx = k0*k1*(x0*x1-y0*y1) + k1*k2*(x1*x2-y1*y2) + k0*k2*(x0*x2-y0*y2);\\n    dd Sy = k0*k1*(y0*x1+y1*x0) + k1*k2*(y1*x2+y2*x1) + k0*k2*(y0*x2+y2*x0);\\n\\n    dd Cx = \",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-built_in\",\"children\":\"sqrt\"}],\"((\",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-built_in\",\"children\":\"sqrt\"}],\"(Sx*Sx+Sy*Sy)+Sx)/\",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-number\",\"children\":\"2\"}],\");\\n    dd Cy = \",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-number\",\"children\":\"0\"}],\";\\n    \",[\"$\",\"span\",\"span-18\",{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\"(Sy != \",[\"$\",\"span\",\"span-19\",{\"className\":\"hljs-number\",\"children\":\"0\"}],\") Cy = \",[\"$\",\"span\",\"span-20\",{\"className\":\"hljs-built_in\",\"children\":\"abs\"}],\"(Sy)/Sy*\",[\"$\",\"span\",\"span-21\",{\"className\":\"hljs-built_in\",\"children\":\"sqrt\"}],\"((\",[\"$\",\"span\",\"span-22\",{\"className\":\"hljs-built_in\",\"children\":\"sqrt\"}],\"(Sx*Sx+Sy*Sy)-Sx)/\",[\"$\",\"span\",\"span-23\",{\"className\":\"hljs-number\",\"children\":\"2\"}],\");\\n    \",[\"$\",\"span\",\"span-24\",{\"className\":\"hljs-keyword\",\"children\":\"else\"}],\" \",[\"$\",\"span\",\"span-25\",{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\"(Sx \u003c \",[\"$\",\"span\",\"span-26\",{\"className\":\"hljs-number\",\"children\":\"0\"}],\") Cy = \",[\"$\",\"span\",\"span-27\",{\"className\":\"hljs-built_in\",\"children\":\"sqrt\"}],\"(-Sx);\\n\\n    dd x_1 = (k0*x0 + k1*x1 + k2*x2 + \",[\"$\",\"span\",\"span-28\",{\"className\":\"hljs-number\",\"children\":\"2\"}],\"*Cx)*r;\\n    dd y_1 = (k0*y0 + k1*y1 + k2*y2 + \",[\"$\",\"span\",\"span-29\",{\"className\":\"hljs-number\",\"children\":\"2\"}],\"*Cy)*r;\\n    dd x_2 = (k0*x0 + k1*x1 + k2*x2 - \",[\"$\",\"span\",\"span-30\",{\"className\":\"hljs-number\",\"children\":\"2\"}],\"*Cx)*r;\\n    dd y_2 = (k0*y0 + k1*y1 + k2*y2 - \",[\"$\",\"span\",\"span-31\",{\"className\":\"hljs-number\",\"children\":\"2\"}],\"*Cy)*r;\\n\\n    _circle c_1 = \",[\"$\",\"span\",\"span-32\",{\"className\":\"hljs-built_in\",\"children\":\"make_pair\"}],\"(r, \",[\"$\",\"span\",\"span-33\",{\"className\":\"hljs-built_in\",\"children\":\"make_pair\"}],\"(x_1, y_1));\\n    _circle c_2 = \",[\"$\",\"span\",\"span-34\",{\"className\":\"hljs-built_in\",\"children\":\"make_pair\"}],\"(r, \",[\"$\",\"span\",\"span-35\",{\"className\":\"hljs-built_in\",\"children\":\"make_pair\"}],\"(x_2, y_2));\\n\\n    dd error1 = (\",[\"$\",\"span\",\"span-36\",{\"className\":\"hljs-built_in\",\"children\":\"check_tangency\"}],\"(c_1, c0) + \",[\"$\",\"span\",\"span-37\",{\"className\":\"hljs-built_in\",\"children\":\"check_tangency\"}],\"(c_1, c1) + \",[\"$\",\"span\",\"span-38\",{\"className\":\"hljs-built_in\",\"children\":\"check_tangency\"}],\"(c_1, c2));\\n    dd error2 = (\",[\"$\",\"span\",\"span-39\",{\"className\":\"hljs-built_in\",\"children\":\"check_tangency\"}],\"(c_2, c0) + \",[\"$\",\"span\",\"span-40\",{\"className\":\"hljs-built_in\",\"children\":\"check_tangency\"}],\"(c_2, c1) + \",[\"$\",\"span\",\"span-41\",{\"className\":\"hljs-built_in\",\"children\":\"check_tangency\"}],\"(c_2, c2));\\n    \\n    \",[\"$\",\"span\",\"span-42\",{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\"(error1 \u003c error2) \",[\"$\",\"span\",\"span-43\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",\"span-44\",{\"className\":\"hljs-built_in\",\"children\":\"make_pair\"}],\"(x_1, y_1);\\n    \",[\"$\",\"span\",\"span-45\",{\"className\":\"hljs-keyword\",\"children\":\"else\"}],\" \",[\"$\",\"span\",\"span-46\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",\"span-47\",{\"className\":\"hljs-built_in\",\"children\":\"make_pair\"}],\"(x_2, y_2);\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-16\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":\"To avoid precision errors, you need to check the tangency, but it's not enough so you need to check the error in the two possible solutions.\"}],\"\\n\",[\"$\",\"h3\",\"h3-2\",{\"className\":\"text-lg font-bold mt-6 mb-3 text-zinc-100\",\"children\":\"P5.js\"}],\"\\n\",[\"$\",\"p\",\"p-17\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"C++\"}],\" is not a good language to make plots or animations, so I searched for other tools for this purpouse. I'll use \",[\"$\",\"code\",\"code-1\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"P5.js\"}],\" and I'll port my \",[\"$\",\"code\",\"code-2\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"C++\"}],\" code to \",[\"$\",\"code\",\"code-3\",{\"className\":\"bg-zinc-900 text-blue-600 px-1 py-0.5 rounded-sm text-xs\",\"children\":\"JS\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-18\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":[\"This is a plot in high resolution with \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"10\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"10\"}]]}]}]]}],\" iterations.\"]}],\"\\n\",\"\\n\",[\"$\",\"div\",\"img-3\",{\"className\":\"image-container my-8\",\"children\":[\"$\",\"img\",null,{\"src\":\"https://raw.githubusercontent.com/HeNeos/heneos.github.io/master/assets/img/PE-199/screenshot.png\",\"alt\":\"screenshot\",\"width\":\"60%\",\"height\":\"auto\",\"className\":\"object-contain mx-auto\"}]}],\"\\n\",[\"$\",\"p\",\"p-19\",{\"className\":\"text-sm text-zinc-300 my-4 leading-relaxed\",\"children\":\"You can also make an animation using this tool.\"}]]}]}]]}]]}],\"$undefined\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/heneos-blog/_next/static/css/5eacd01f773eed7f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L5\",null,{\"children\":[\"$L6\",\"$L7\",null]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"wj7roPt4iS0RMA0f5SR-B\",{\"children\":[[\"$\",\"$L8\",null,{\"children\":\"$L9\"}],null]}],[\"$\",\"$La\",null,{\"children\":\"$Lb\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$c\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"9:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n6:null\n"])</script><script>self.__next_f.push([1,"7:null\nb:[[\"$\",\"title\",\"0\",{\"children\":\"Project Euler 199 | HeNeos blog\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Solving Project Euler 199 | Iterative Circle Packing\"}]]\n"])</script></body></html>